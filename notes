# search for lost met filters

foreach ver (v17  v18  v19  v20  v21  v22  v23)
python sumup_ttree_distrs.py "pass_basic_METfilters + METfilterbadChCand + METfilterbadPFMuon" --histo-range 5,-1.,4. --histo-name ${ver}_singlemu_met_filters --output ${ver}_singlemu_met_filters.root gstore_outdirs/${ver}/SingleMuon/Ntupler_${ver}_Data13TeV_SingleMuon2016*/*/*/*root &
end

foreach ver (v24  v25  v26  v27  v28  v29  v30  v31v27)
python sumup_ttree_distrs.py "pass_basic_METfilters + METfilterbadChCand + METfilterbadPFMuon" --histo-range 5,-1.,4. --histo-name ${ver}_singlemu_met_filters --output ${ver}_singlemu_met_filters.root gstore_outdirs/${ver}/SingleMuon/Ntupler_${ver}_Data13TeV_SingleMuon2016*/*/*/*root &
end

ok, 0.2% in v31v27
checking elmu close

python sumup_ttree_distrs.py "pass_basic_METfilters + METfilterbadChCand + METfilterbadPFMuon" --histo-range 5,-1.,4. --cond-com "nbjets > 0 && leps_ID == -13*11 && HLT_mu && lep_matched_HLT[0] && no_iso_veto_leps && lep_p4[0].pt() > 30 && abs(lep_p4[0].eta()) < 2.4 && lep_p4[1].pt() > 30 && abs(lep_p4[1].eta()) < 2.4" --histo-name v31v27_elmu_close_met_filters_data --output v31v27_elmu_close_met_filters_data.root gstore_outdirs/v31v27/SingleMuon/Ntupler_v31v27_Data13TeV_SingleMuon2016*/*/*/*root &

python sumup_ttree_distrs.py "pass_basic_METfilters + METfilterbadChCand + METfilterbadPFMuon" --histo-range 5,-1.,4. --cond-com "leps_ID == -13*11 && HLT_mu && lep_matched_HLT[0] && no_iso_veto_leps && lep_p4[0].pt() > 30 && abs(lep_p4[0].eta()) < 2.4 && lep_p4[1].pt() > 30 && abs(lep_p4[1].eta()) < 2.4" --histo-name v31v27_elmu_met_filters_data --output v31v27_elmu_met_filters_data.root gstore_outdirs/v31v27/SingleMuon/Ntupler_v31v27_Data13TeV_SingleMuon2016*/*/*/*root &

-- 0.8 % close  (1124 events)
   0.79% simple (1380 events)

check which break:

python sumup_ttree_distrs.py "pass_basic_METfilters" --histo-range 5,-1.,4. --cond-com "leps_ID == -13*11 && HLT_mu && lep_matched_HLT[0] && no_iso_veto_leps && lep_p4[0].pt() > 30 && abs(lep_p4[0].eta()) < 2.4 && lep_p4[1].pt() > 30 && abs(lep_p4[1].eta()) < 2.4" --histo-name v31v27_elmu_met_filters_basic_data --output v31v27_elmu_met_filters_basic_data.root gstore_outdirs/v31v27/SingleMuon/Ntupler_v31v27_Data13TeV_SingleMuon2016*/*/*/*root &

python sumup_ttree_distrs.py "METfilterbadChCand" --histo-range 5,-1.,4. --cond-com "leps_ID == -13*11 && HLT_mu && lep_matched_HLT[0] && no_iso_veto_leps && lep_p4[0].pt() > 30 && abs(lep_p4[0].eta()) < 2.4 && lep_p4[1].pt() > 30 && abs(lep_p4[1].eta()) < 2.4" --histo-name v31v27_elmu_met_filters_badCh_data --output v31v27_elmu_met_filters_badCh_data.root gstore_outdirs/v31v27/SingleMuon/Ntupler_v31v27_Data13TeV_SingleMuon2016*/*/*/*root &

python sumup_ttree_distrs.py "METfilterbadPFMuon" --histo-range 5,-1.,4. --cond-com "leps_ID == -13*11 && HLT_mu && lep_matched_HLT[0] && no_iso_veto_leps && lep_p4[0].pt() > 30 && abs(lep_p4[0].eta()) < 2.4 && lep_p4[1].pt() > 30 && abs(lep_p4[1].eta()) < 2.4" --histo-name v31v27_elmu_met_filters_PFMuon_data --output v31v27_elmu_met_filters_PFMuon_data.root gstore_outdirs/v31v27/SingleMuon/Ntupler_v31v27_Data13TeV_SingleMuon2016*/*/*/*root &



python sumup_ttree_distrs.py "pass_basic_METfilters + METfilterbadChCand + METfilterbadPFMuon" --histo-range 5,-1.,4. --cond-com "leps_ID == -13*11 && HLT_mu && lep_matched_HLT[0] && no_iso_veto_leps && lep_p4[0].pt() > 30 && abs(lep_p4[0].eta()) < 2.4 && lep_p4[1].pt() > 30 && abs(lep_p4[1].eta()) < 2.4" --histo-name v31v27_elmu_met_filters_tt --output v31v27_elmu_met_filters_tt.root gstore_outdirs/v31v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v31v27_MC2016_Summer16_TTJets_powheg/180522_225221/0000/*root &

-- out of nowhere TT also has 0.8% such events!
   it is MC! it does not have met filters!






# tt em close

python sumup_ttree_distrs.py "lep_p4[0].pt()" --cond-com "nbjets > 0 && leps_ID == -13*11 && HLT_mu && lep_matched_HLT[0] && no_iso_veto_leps && lep_p4[0].pt() > 30 && abs(lep_p4[0].eta()) < 2.4 && lep_p4[1].pt() > 30 && abs(lep_p4[1].eta()) < 2.4" --histo-range 100,0.,250. --histo-name v31v27_elmu_close_lep0_pt_tt   --output v31v27_elmu_close_lep0_pt_tt.root   gstore_outdirs/v31v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v31v27_MC2016_Summer16_TTJets_powheg/180522_225221/0000/*root &

python sumup_ttree_distrs.py "lep_p4[0].pt()" --cond-com "nbjets > 0 && leps_ID == -13*11 && HLT_mu && lep_matched_HLT[0] && no_iso_veto_leps && lep_p4[0].pt() > 30 && abs(lep_p4[0].eta()) < 2.4 && lep_p4[1].pt() > 30 && abs(lep_p4[1].eta()) < 2.4" --histo-range 100,0.,250. --histo-name v31v27_elmu_close_lep0_pt_data --output v31v27_elmu_close_lep0_pt_data.root gstore_outdirs/v31v27/SingleMuon/Ntupler_v31v27_Data13TeV_SingleMuon2016*/*/*/*root &

-- not all jobs now!!!

old ntuples:

python sumup_ttree_distrs.py "lep_p4[0].pt()" --cond-com "nbjets > 0 && leps_ID == -13*11 && HLT_mu && lep_matched_HLT[0] && no_iso_veto_leps && lep_p4[0].pt() > 30 && abs(lep_p4[0].eta()) < 2.4 && lep_p4[1].pt() > 30 && abs(lep_p4[1].eta()) < 2.4" --histo-range 100,0.,250. --histo-name v27_elmu_close_lep0_pt_tt_old   --output v27_elmu_close_lep0_pt_tt_old.root   gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &

python sumup_ttree_distrs.py "lep_p4[0].pt()" --cond-com "nbjets > 0 && leps_ID == -13*11 && HLT_mu && lep_matched_HLT[0] && no_iso_veto_leps && lep_p4[0].pt() > 30 && abs(lep_p4[0].eta()) < 2.4 && lep_p4[1].pt() > 30 && abs(lep_p4[1].eta()) < 2.4" --histo-range 100,0.,250. --histo-name v27_elmu_close_lep0_pt_data_old --output v27_elmu_close_lep0_pt_data_old.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016*/*/*/*root &

old w.o. D:

python sumup_ttree_distrs.py "lep_p4[0].pt()" --cond-com "nbjets > 0 && leps_ID == -13*11 && HLT_mu && lep_matched_HLT[0] && no_iso_veto_leps && lep_p4[0].pt() > 30 && abs(lep_p4[0].eta()) < 2.4 && lep_p4[1].pt() > 30 && abs(lep_p4[1].eta()) < 2.4" --histo-range 100,0.,250. --histo-name v27_elmu_close_lep0_pt_data_old_noD --output v27_elmu_close_lep0_pt_data_old_noD.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016[BCEFGH]*/*/*/*root &


-- 0.5% less events in data after fix





# check the alliso 0 in elmu

python sumup_ttree_distrs.py "lep_alliso_p4[0].pt()"  --histo-range 100,0.0,250. --cond "leps_ID == -13*11 && (HLT_mu) && (lep_matched_HLT[0]) && no_iso_veto_leps && (lep_p4[0].pt() > 30 && abs(lep_p4[0].eta()) < 2.4) && (lep_p4[1].pt() > 30 && abs(lep_p4[1].eta()) < 2.4)" --histo-name test_tt_em_alliso_lep_pt  --output test_tt_em_alliso_lep_pt.root  gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/180416_131355/0000/MC2016_Summer16_TTJets_powheg_*.root &
python sumup_ttree_distrs.py "lep_alliso_p4[0].eta()" --histo-range 100,-2.5,2.5 --cond "leps_ID == -13*11 && (HLT_mu) && (lep_matched_HLT[0]) && no_iso_veto_leps && (lep_p4[0].pt() > 30 && abs(lep_p4[0].eta()) < 2.4) && (lep_p4[1].pt() > 30 && abs(lep_p4[1].eta()) < 2.4)" --histo-name test_tt_em_alliso_lep_eta --output test_tt_em_alliso_lep_eta.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/180416_131355/0000/MC2016_Summer16_TTJets_powheg_*.root &

python sumup_ttree_distrs.py "lep_alliso_p4[0].pt()"  --histo-range 100,0.0,250. --cond "leps_ID == -13*11 && (HLT_mu) && (lep_matched_HLT[0]) && no_iso_veto_leps && (lep_p4[0].pt() > 30 && abs(lep_p4[0].eta()) < 2.4) && (lep_p4[1].pt() > 30 && abs(lep_p4[1].eta()) < 2.4)" --histo-name test_data_em_alliso_lep_pt  --output test_data_em_alliso_lep_pt.root  gstore_outdirs/v27/SingleMuon/*/*/*/*root &
python sumup_ttree_distrs.py "lep_alliso_p4[0].eta()" --histo-range 100,-2.5,2.5 --cond "leps_ID == -13*11 && (HLT_mu) && (lep_matched_HLT[0]) && no_iso_veto_leps && (lep_p4[0].pt() > 30 && abs(lep_p4[0].eta()) < 2.4) && (lep_p4[1].pt() > 30 && abs(lep_p4[1].eta()) < 2.4)" --histo-name test_data_em_alliso_lep_eta --output test_data_em_alliso_lep_eta.root gstore_outdirs/v27/SingleMuon/*/*/*/*root &

compare to actual muon on 0 position

python sumup_ttree_distrs.py "lep_p4[0].pt()"  --histo-range 100,0.0,250. --cond "leps_ID == -13*11 && (HLT_mu) && (lep_matched_HLT[0]) && no_iso_veto_leps && (lep_p4[0].pt() > 30 && abs(lep_p4[0].eta()) < 2.4) && (lep_p4[1].pt() > 30 && abs(lep_p4[1].eta()) < 2.4)" --histo-name test_tt_em_lep0_pt  --output test_tt_em_lep0_pt.root  gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/180416_131355/0000/MC2016_Summer16_TTJets_powheg_*.root &
python sumup_ttree_distrs.py "lep_p4[0].eta()" --histo-range 100,-2.5,2.5 --cond "leps_ID == -13*11 && (HLT_mu) && (lep_matched_HLT[0]) && no_iso_veto_leps && (lep_p4[0].pt() > 30 && abs(lep_p4[0].eta()) < 2.4) && (lep_p4[1].pt() > 30 && abs(lep_p4[1].eta()) < 2.4)" --histo-name test_tt_em_lep0_eta --output test_tt_em_lep0_eta.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/180416_131355/0000/MC2016_Summer16_TTJets_powheg_*.root &








# sumup test in tt em

python sumup_ttree_distrs.py "lep_p4[0].pt()" --histo-range 100,0.0,250. --cond "leps_ID == -13*11 && (HLT_mu) && (lep_matched_HLT[0]) && no_iso_veto_leps && (lep_p4[0].pt() > 30 && abs(lep_p4[0].eta()) < 2.4) && (lep_p4[1].pt() > 30 && abs(lep_p4[1].eta()) < 2.4)" --histo-name test_tt_em_lep_pt --output test_tt_em_lep_pt.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/180416_131355/0000/MC2016_Summer16_TTJets_powheg_*.root &

-- without reliso and eta crack stuff, since it is embedded in NT!

python sumup_histo.py

python sumup_histo.py ntupler/weight_counter --output test_tt_weight_counters.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/180416_131355/0000/MC2016_Summer16_TTJets_powheg_*.root &




in mu data

python sumup_ttree_distrs.py "lep_p4[0].pt()" --histo-range 100,0.0,250. --cond "leps_ID == -13*11 && (HLT_mu) && (lep_matched_HLT[0]) && no_iso_veto_leps && (lep_p4[0].pt() > 30 && abs(lep_p4[0].eta()) < 2.4) && (lep_p4[1].pt() > 30 && abs(lep_p4[1].eta()) < 2.4)" --histo-name test_data_em_lep_pt --output test_data_em_lep_pt.root gstore_outdirs/v27/SingleMuon/*/*/*/*root

python sumup_histo.py ntupler/weight_counter --output test_data_weight_counters.root gstore_outdirs/v27/SingleMuon/*/*/*/*root &






# lep-jet dR

python sumup_ttree_distrs.py "jet_matching_lep_dR[0]" --cond "leps_ID == -13*13 && (HLT_mu) && (lep_matched_HLT[0]) && no_iso_veto_leps && (lep_p4[0].pt() > 30 && abs(lep_p4[0].eta()) < 2.4) && (lep_p4[1].pt() > 30 && abs(lep_p4[1].eta()) < 2.4)" --histo-range 100,0.0,0.5 --histo-name mumu_hlt0_jetmatchdR0_dy --output mumu_hlt0_jetmatchdR0_dy.root gstore_outdirs/v27/DYJetsToLL_M-50_TuneCUETP8M1_13TeV-madgraphMLM-pythia8/Ntupler_v27_MC2016_Summer16_DYJetsToLL_50toInf_madgraph/180416_124902/0000/*root &
python sumup_ttree_distrs.py "jet_matching_lep_dR[1]" --cond "leps_ID == -13*13 && (HLT_mu) && (lep_matched_HLT[0]) && no_iso_veto_leps && (lep_p4[0].pt() > 30 && abs(lep_p4[0].eta()) < 2.4) && (lep_p4[1].pt() > 30 && abs(lep_p4[1].eta()) < 2.4)" --histo-range 100,0.0,0.5 --histo-name mumu_hlt0_jetmatchdR1_dy --output mumu_hlt0_jetmatchdR1_dy.root gstore_outdirs/v27/DYJetsToLL_M-50_TuneCUETP8M1_13TeV-madgraphMLM-pythia8/Ntupler_v27_MC2016_Summer16_DYJetsToLL_50toInf_madgraph/180416_124902/0000/*root &

python sumup_ttree_distrs.py "jet_matching_lep_dR[0]" --cond "leps_ID == -11*11 && (HLT_el) && (lep_matched_HLT[0]) && no_iso_veto_leps && (lep_p4[0].pt() > 30 && abs(lep_p4[0].eta()) < 2.4) && (lep_p4[1].pt() > 30 && abs(lep_p4[1].eta()) < 2.4)" --histo-range 100,0.0,0.5 --histo-name elel_hlt0_jetmatchdR0_dy --output elel_hlt0_jetmatchdR0_dy.root gstore_outdirs/v27/DYJetsToLL_M-50_TuneCUETP8M1_13TeV-madgraphMLM-pythia8/Ntupler_v27_MC2016_Summer16_DYJetsToLL_50toInf_madgraph/180416_124902/0000/*root &
python sumup_ttree_distrs.py "jet_matching_lep_dR[1]" --cond "leps_ID == -11*11 && (HLT_el) && (lep_matched_HLT[0]) && no_iso_veto_leps && (lep_p4[0].pt() > 30 && abs(lep_p4[0].eta()) < 2.4) && (lep_p4[1].pt() > 30 && abs(lep_p4[1].eta()) < 2.4)" --histo-range 100,0.0,0.5 --histo-name elel_hlt0_jetmatchdR1_dy --output elel_hlt0_jetmatchdR1_dy.root gstore_outdirs/v27/DYJetsToLL_M-50_TuneCUETP8M1_13TeV-madgraphMLM-pythia8/Ntupler_v27_MC2016_Summer16_DYJetsToLL_50toInf_madgraph/180416_124902/0000/*root &




data

python sumup_ttree_distrs.py "jet_matching_lep_dR[0]" --cond "leps_ID == -13*13 && (HLT_mu) && (lep_matched_HLT[0]) && no_iso_veto_leps && (lep_p4[0].pt() > 30 && abs(lep_p4[0].eta()) < 2.4) && (lep_p4[1].pt() > 30 && abs(lep_p4[1].eta()) < 2.4)" --histo-range 100,0.0,0.5 --histo-name mumu_hlt0_jetmatchdR0_data --output mumu_hlt0_jetmatchdR0_data.root gstore_outdirs/v27/SingleMuon/*/*/*/*root &
python sumup_ttree_distrs.py "jet_matching_lep_dR[1]" --cond "leps_ID == -13*13 && (HLT_mu) && (lep_matched_HLT[0]) && no_iso_veto_leps && (lep_p4[0].pt() > 30 && abs(lep_p4[0].eta()) < 2.4) && (lep_p4[1].pt() > 30 && abs(lep_p4[1].eta()) < 2.4)" --histo-range 100,0.0,0.5 --histo-name mumu_hlt0_jetmatchdR1_data --output mumu_hlt0_jetmatchdR1_data.root gstore_outdirs/v27/SingleMuon/*/*/*/*root &

python sumup_ttree_distrs.py "jet_matching_lep_dR[0]" --cond "leps_ID == -11*11 && (HLT_el) && (lep_matched_HLT[0]) && no_iso_veto_leps && (lep_p4[0].pt() > 30 && abs(lep_p4[0].eta()) < 2.4) && (lep_p4[1].pt() > 30 && abs(lep_p4[1].eta()) < 2.4)" --histo-range 100,0.0,0.5 --histo-name elel_hlt0_jetmatchdR0_data --output elel_hlt0_jetmatchdR0_data.root gstore_outdirs/v27/SingleElectron/*/*/*/*root &
python sumup_ttree_distrs.py "jet_matching_lep_dR[1]" --cond "leps_ID == -11*11 && (HLT_el) && (lep_matched_HLT[0]) && no_iso_veto_leps && (lep_p4[0].pt() > 30 && abs(lep_p4[0].eta()) < 2.4) && (lep_p4[1].pt() > 30 && abs(lep_p4[1].eta()) < 2.4)" --histo-range 100,0.0,0.5 --histo-name elel_hlt0_jetmatchdR1_data --output elel_hlt0_jetmatchdR1_data.root gstore_outdirs/v27/SingleElectron/*/*/*/*root &

-- jets 0 and 1 have about 90% probability to match to lep
2, 3 are 20 and 10 %




# dR of HLT match

mumu selection just to try

python sumup_ttree_distrs.py "lep_matched_HLT_dR[0]" --cond-com "leps_ID == -13*13 && HLT_mu" --histo-range 100,0.0,0.4  --histo-name mumu_lepmatch_HLT_dR_data --output mumu_lepmatch_HLT_dR_data.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016*/1*/*/*root &
python sumup_ttree_distrs.py "lep_matched_HLT_dR[0]" --cond-com "leps_ID == -13*13 && HLT_mu" --histo-range 100,0.0,0.4  --histo-name mumu_lepmatch_HLT_dR_tt   --output mumu_lepmatch_HLT_dR_tt.root   gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &

how much are not matched?
elmu HLT match

python sumup_ttree_distrs.py "lep_matched_HLT[0]" --cond-com "leps_ID == -13*11 && HLT_mu" --histo-range 3,-1.,2 --histo-name elmu_lepmatch_HLT0_tt   --output elmu_lepmatch_HLT0_tt.root   gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &
python sumup_ttree_distrs.py "lep_matched_HLT[0]" --cond-com "leps_ID == -13*11 && HLT_mu" --histo-range 3,-1.,2 --histo-name elmu_lepmatch_HLT0_data --output elmu_lepmatch_HLT0_data.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016*/1*/*/*root &

-- both very good match
14 / 523759.
in tt
16 / 257533.
in data

and el:

python sumup_ttree_distrs.py "lep_matched_HLT[1]" --cond-com "leps_ID == -13*11 && HLT_mu" --histo-range 3,-1.,2 --histo-name elmu_lepmatch_HLT1_tt   --output elmu_lepmatch_HLT1_tt.root   gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &
python sumup_ttree_distrs.py "lep_matched_HLT[1]" --cond-com "leps_ID == -13*11 && HLT_mu" --histo-range 3,-1.,2 --histo-name elmu_lepmatch_HLT1_data --output elmu_lepmatch_HLT1_data.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016*/1*/*/*root &

67475.0 / 456298.
in tt
45813.0 / 211736.
in data

not matched 21% in data, 14% in tt

check the muon:

python sumup_ttree_distrs.py "abs(lep_id[0])" --cond-com "leps_ID == -13*11 && HLT_mu" --histo-range 21,-1.,20. --histo-name elmu_lepid0_tt   --output elmu_lepid0_tt.root   gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &
python sumup_ttree_distrs.py "abs(lep_id[1])" --cond-com "leps_ID == -13*11 && HLT_mu" --histo-range 21,-1.,20. --histo-name elmu_lepid1_tt   --output elmu_lepid1_tt.root   gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &

python sumup_ttree_distrs.py "abs(lep_id[0])" --cond-com "leps_ID == -13*11 && HLT_mu" --histo-range 21,-1.,20. --histo-name elmu_lepid0_data --output elmu_lep0_data.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016*/1*/*/*root &
python sumup_ttree_distrs.py "abs(lep_id[1])" --cond-com "leps_ID == -13*11 && HLT_mu" --histo-range 21,-1.,20. --histo-name elmu_lepid1_data --output elmu_lep1_data.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016*/1*/*/*root &

tt:
lep0 = 13
lep1 = 11
data:
same

check HLT match of electron with full elmu_close requirement

python sumup_ttree_distrs.py "lep_matched_HLT[1]" --cond-com "leps_ID == -13*11 && HLT_mu && no_iso_veto_leps && lep_p4[0].pt() > 30 && abs(lep_p4[0].eta()) < 2.4 && lep_p4[1].pt() > 30 && abs(lep_p4[1].eta()) < 2.4" --histo-range 3,-1.,2 --histo-name elmu_close_lepmatch_HLT1_tt   --output elmu_close_lepmatch_HLT1_tt.root   gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &
python sumup_ttree_distrs.py "lep_matched_HLT[1]" --cond-com "leps_ID == -13*11 && HLT_mu && no_iso_veto_leps && lep_p4[0].pt() > 30 && abs(lep_p4[0].eta()) < 2.4 && lep_p4[1].pt() > 30 && abs(lep_p4[1].eta()) < 2.4" --histo-range 3,-1.,2 --histo-name elmu_close_lepmatch_HLT1_data --output elmu_close_lepmatch_HLT1_data.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016*/1*/*/*root &

(even if it works, then the problem: it breaks the equality of triggers with lep-tau proces...................)

still:
tt    12/100
49227.0 / 385230.
data  16/100
28577.0 / 171436.

how large is ele HLT SF?

python module_leptons.py el_trigSF_in_elmu_close.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root

for eta = 2.1, pt = 30.1
sf, uncert = 0.8545982188646293, 0.02278517998528972

why so large?
-- check in the file

about 0.975597

and:

bpython version 0.15 on top of Python 3.5.2 /usr/bin/python3
>>> 49227.0 / 385230.
0.12778599797523557
>>> 385230. / (49227.0 + 385230.)
0.8866930444209669
>>> 
>>> 171436. / (28577.0 + 171436.)
0.8571242869213501
>>> 0.8571242869213501 / 0.8866930444209669
0.966652769314407

-- so, 1 percent off




# tt decayID check no default value

if W_num < 0 continue

gen_t_w_decay_id
gen_t_w_decay_id

-- then I'd have "tt_other"


# what if

muon objects are matched so well because of a mistake

matched_muTriggerName1 = ""
utils::passTriggerPatternsAndGetName(tr, matched_muTriggerName1, muHLT_MC1)

   -> from llvv/src/MacroUtils.cc
      if(tr.accept( pattern.c_str() ) ) { pathName = pattern; return true;}
      else return false

   can be false, ""
   and another trig is true "foobar"
   overl trigger is true and

if overall_trigger = True:

   Processing_selectHLTobjects(trig_objs, trigNames, mu_trig_objs,  matched_muTriggerName1)
   Processing_selectHLTobjects(trig_objs, trigNames, mu_trig_objs2, matched_muTriggerName2)
   mu_trig_objs.insert(mu_trig_objs.end(), mu_trig_objs2.begin(), mu_trig_objs2.end());

   in Processing
       -> is_our_hlt |= (obj.pathNames()[h].find(targetHLT) != std::string::npos);
       -- if "" matches to all trig objects
          then non-triggered objects will pass

I have cases like:

passed HLT 0 1(1,0); HLT_IsoMu24_v1,
passed HLT 0 1(1,0); HLT_IsoMu24_v1,
passed HLT 0 1(1,1); HLT_IsoMu24_v1,HLT_IsoTkMu24_v1
passed HLT 0 1(1,1); HLT_IsoMu24_v1,HLT_IsoTkMu24_v1
passed HLT 0 1(0,1); ,HLT_IsoTkMu24_v1

-- debug N objects in each of muon collections

passed HLT 0 1(0,1); ,HLT_IsoTkMu24_v1 0 6(4,2)
passed HLT 0 1(1,0); HLT_IsoMu24_v1, 0 6(3,3)

-- fixed it,
now it's:

passed HLT 0 1(0,1); ,HLT_IsoTkMu24_v1 0 2(0,2)
passed HLT 0 1(1,0); HLT_IsoMu24_v1, 0 3(3,0)



-- how lepons pass?

-- hard to see elmu events and catch muons
   in case of only 1 type of muon HLT
   50-50% of these mouns pass selection or fall into veto leptons

sub jobs anyway
v31v27






# PU and nvtx gen

python sumup_ttree_distrs.py "nvtx_gen" --histo-range 75,0.,75. --histo-name tt_nvtx_gen --output tt_nvtx_gen.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root





# effect from SingleMuon RunG

Data Mt with and without RunG

python jobsums/get_shapes.py --formula "BCDEF:GH" -c ctr_old_mu_presel2b  -d Mt_lep_met_f -p data BCDEF:merge-sets/v25/pF9/SingleMuonBCDEF.root GH:merge-sets/v25/pF9/SingleMuonGH.root

python jobsums/get_shapes.py --formula "BCDEF:GH" -c ctr_old_mu_sel       -d Mt_lep_met_f -p data BCDEF:merge-sets/v25/pF9/SingleMuonBCDEF.root GH:merge-sets/v25/pF9/SingleMuonGH.root




python jobsums/get_shapes.py --formula "full:noG" -c ctr_old_mu_sel       -d Mt_lep_met_f -p data noG:merge-sets/v25/pF9/SingleMuonNoG.root full:merge-sets/v25/pF9/SingleMuon.root
python jobsums/get_shapes.py --formula "full:noG" -c ctr_old_mu_selVloose -d Mt_lep_met_f -p data noG:merge-sets/v25/pF9/SingleMuonNoG.root full:merge-sets/v25/pF9/SingleMuon.root
python jobsums/get_shapes.py --formula "full:noG" -c ctr_old_mu_presel    -d Mt_lep_met_f -p data noG:merge-sets/v25/pF9/SingleMuonNoG.root full:merge-sets/v25/pF9/SingleMuon.root
python jobsums/get_shapes.py --formula "full:noG" -c ctr_old_mu_presel2b  -d Mt_lep_met_f -p data noG:merge-sets/v25/pF9/SingleMuonNoG.root full:merge-sets/v25/pF9/SingleMuon.root

python jobsums/get_shapes.py --formula "runB:runC:runD:runE:runF:runG:runH" -c ctr_old_mu_presel2b  -d Mt_lep_met_f -p data runB:merge-sets/v25/pF9/Data13TeV_SingleMuon2016B_03Feb2017_ver2.root runC:merge-sets/v25/pF9/Data13TeV_SingleMuon2016C_03Feb2017_v1.root runD:merge-sets/v25/pF9/Data13TeV_SingleMuon2016D_03Feb2017_v1.root runE:merge-sets/v25/pF9/Data13TeV_SingleMuon2016E_03Feb2017_v1.root runF:merge-sets/v25/pF9/Data13TeV_SingleMuon2016F_03Feb2017_v1.root runG:merge-sets/v25/pF9/Data13TeV_SingleMuon2016G_03Feb2017_v1.root runH:merge-sets/v25/pF9/Data13TeV_SingleMuon2016H_03Feb2017_ver2.root

python jobsums/get_shapes.py --formula "runB:runC:runD:runE:runF:runG:runH" -c ctr_old_mu_selVloose  -d Mt_lep_met_f -p data runB:merge-sets/v25/pF9/Data13TeV_SingleMuon2016B_03Feb2017_ver2.root runC:merge-sets/v25/pF9/Data13TeV_SingleMuon2016C_03Feb2017_v1.root runD:merge-sets/v25/pF9/Data13TeV_SingleMuon2016D_03Feb2017_v1.root runE:merge-sets/v25/pF9/Data13TeV_SingleMuon2016E_03Feb2017_v1.root runF:merge-sets/v25/pF9/Data13TeV_SingleMuon2016F_03Feb2017_v1.root runG:merge-sets/v25/pF9/Data13TeV_SingleMuon2016G_03Feb2017_v1.root runH:merge-sets/v25/pF9/Data13TeV_SingleMuon2016H_03Feb2017_ver2.root

python jobsums/get_shapes.py --formula "runB:runC:runD:runE:runF:runG:runH" -c ctr_old_mu_sel  -d Mt_lep_met_f -p data runB:merge-sets/v25/pF9/Data13TeV_SingleMuon2016B_03Feb2017_ver2.root runC:merge-sets/v25/pF9/Data13TeV_SingleMuon2016C_03Feb2017_v1.root runD:merge-sets/v25/pF9/Data13TeV_SingleMuon2016D_03Feb2017_v1.root runE:merge-sets/v25/pF9/Data13TeV_SingleMuon2016E_03Feb2017_v1.root runF:merge-sets/v25/pF9/Data13TeV_SingleMuon2016F_03Feb2017_v1.root runG:merge-sets/v25/pF9/Data13TeV_SingleMuon2016G_03Feb2017_v1.root runH:merge-sets/v25/pF9/Data13TeV_SingleMuon2016H_03Feb2017_ver2.root




# mumu DY for detector response in muon phi

python sumup_ttree_distrs.py "sqrt((lep_p4[0].E() + lep_p4[1].E())*(lep_p4[0].E() + lep_p4[1].E()) - (lep_p4[0].Px() + lep_p4[1].Px())*(lep_p4[0].Px() + lep_p4[1].Px()) - (lep_p4[0].Py() + lep_p4[1].Py())*(lep_p4[0].Py() + lep_p4[1].Py()) - (lep_p4[0].Pz() + lep_p4[1].Pz())*(lep_p4[0].Pz() + lep_p4[1].Pz()))" --cond-com "leps_ID == -13*13 && HLT_mu && lep_matched_HLT[0]" --histo-range 50,0.,150  --histo-name mumu_mass_data --output mumu_mass_data.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016*/1*/*/*root &

python sumup_ttree_distrs.py "lep_p4[0].phi()" --cond-com "leps_ID == -13*13 && HLT_mu && lep_matched_HLT[0]" --histo-range 66,-3.3,3.3  --histo-name mumu_phi0_data --output mumu_phi0_data.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016*/1*/*/*root &

python sumup_ttree_distrs.py "abs(lep_p4[0].phi())" --cond-com "lep_p4[0].phi() > 0 && leps_ID == -13*13 && HLT_mu && lep_matched_HLT[0]" --histo-range 66,-3.3,3.3  --histo-name mumu_phi0_pos_data --output mumu_phi0_pos_data.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016*/1*/*/*root &

python sumup_ttree_distrs.py "abs(lep_p4[0].phi())" --cond-com "lep_p4[0].phi() < 0 && leps_ID == -13*13 && HLT_mu && lep_matched_HLT[0]" --histo-range 66,-3.3,3.3  --histo-name mumu_phi0_neg_data --output mumu_phi0_neg_data.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016*/1*/*/*root &

python sumup_ttree_distrs.py "abs(lep_p4[0].phi())" --cond-com " leps_ID == -13*13 && HLT_mu && lep_matched_HLT[0]" --histo-range 66,-3.3,3.3  --histo-name mumu_phi0_abs_data --output mumu_phi0_abs_data.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016*/1*/*/*root &

python sumup_ttree_distrs.py "abs(abs(lep_p4[0].phi()) - 3.1415)" --cond-com " leps_ID == -13*13 && HLT_mu && lep_matched_HLT[0]" --histo-range 66,-3.3,3.3  --histo-name mumu_phi0_absinv_data --output mumu_phi0_absinv_data.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016*/1*/*/*root &




phis in RunG (the one with kinks in Mt)

python sumup_ttree_distrs.py "lep_p4[0].phi()" --cond-com "leps_ID == -13*13 && HLT_mu && lep_matched_HLT[0]" --histo-range 66,-3.3,3.3  --histo-name mumu_phi0_dataG --output mumu_phi0_dataG.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016G*/1*/*/*root &

python sumup_ttree_distrs.py "abs(lep_p4[0].phi())" --cond-com "lep_p4[0].phi() > 0 && leps_ID == -13*13 && HLT_mu && lep_matched_HLT[0]" --histo-range 66,-3.3,3.3  --histo-name mumu_phi0_pos_dataG --output mumu_phi0_pos_dataG.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016G*/1*/*/*root &

python sumup_ttree_distrs.py "abs(lep_p4[0].phi())" --cond-com "lep_p4[0].phi() < 0 && leps_ID == -13*13 && HLT_mu && lep_matched_HLT[0]" --histo-range 66,-3.3,3.3  --histo-name mumu_phi0_neg_dataG --output mumu_phi0_neg_dataG.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016G*/1*/*/*root &

python sumup_ttree_distrs.py "abs(lep_p4[0].phi())" --cond-com " leps_ID == -13*13 && HLT_mu && lep_matched_HLT[0]" --histo-range 66,-3.3,3.3  --histo-name mumu_phi0_abs_dataG --output mumu_phi0_abs_dataG.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016G*/1*/*/*root &

python sumup_ttree_distrs.py "abs(abs(lep_p4[0].phi()) - 3.1415)" --cond-com " leps_ID == -13*13 && HLT_mu && lep_matched_HLT[0]" --histo-range 66,-3.3,3.3  --histo-name mumu_phi0_absinv_dataG --output mumu_phi0_absinv_dataG.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016G*/1*/*/*root &



eta asym in all

python sumup_ttree_distrs.py "abs(lep_p4[0].eta())" --cond-com "lep_p4[0].eta() < 0 && leps_ID == -13*13 && HLT_mu && lep_matched_HLT[0]" --histo-range 66,-3.3,3.3  --histo-name mumu_eta0_neg_data --output mumu_eta0_neg_data.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016*/1*/*/*root &

python sumup_ttree_distrs.py "abs(lep_p4[0].eta())" --cond-com "lep_p4[0].eta() > 0 && leps_ID == -13*13 && HLT_mu && lep_matched_HLT[0]" --histo-range 66,-3.3,3.3  --histo-name mumu_eta0_pos_data --output mumu_eta0_pos_data.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016*/1*/*/*root &

python sumup_ttree_distrs.py "lep_p4[0].pt()" --cond-com "leps_ID == -13*13 && HLT_mu && lep_matched_HLT[0]" --histo-range 75,0.,150.0  --histo-name mumu_pt0_data --output mumu_pt0_data.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016*/1*/*/*root &


python sumup_ttree_distrs.py "abs(lep_p4[1].eta())" --cond-com "lep_p4[1].eta() < 0 && leps_ID == -13*13 && HLT_mu && lep_matched_HLT[0]" --histo-range 66,-3.3,3.3  --histo-name mumu_eta1_neg_data --output mumu_eta1_neg_data.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016*/1*/*/*root &

python sumup_ttree_distrs.py "abs(lep_p4[1].eta())" --cond-com "lep_p4[1].eta() > 0 && leps_ID == -13*13 && HLT_mu && lep_matched_HLT[0]" --histo-range 66,-3.3,3.3  --histo-name mumu_eta1_pos_data --output mumu_eta1_pos_data.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016*/1*/*/*root &

python sumup_ttree_distrs.py "lep_p4[1].pt()" --cond-com "leps_ID == -13*13 && HLT_mu && lep_matched_HLT[0]" --histo-range 75,0.,150.0  --histo-name mumu_pt1_data --output mumu_pt1_data.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016*/1*/*/*root &




and phi of lep1

python sumup_ttree_distrs.py "abs(lep_p4[1].phi())" --cond-com "lep_p4[1].phi() > 0 && leps_ID == -13*13 && HLT_mu && lep_matched_HLT[0]" --histo-range 66,-3.3,3.3  --histo-name mumu_phi1_pos_data --output mumu_phi1_pos_data.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016*/1*/*/*root &

python sumup_ttree_distrs.py "abs(lep_p4[1].phi())" --cond-com "lep_p4[1].phi() < 0 && leps_ID == -13*13 && HLT_mu && lep_matched_HLT[0]" --histo-range 66,-3.3,3.3  --histo-name mumu_phi1_neg_data --output mumu_phi1_neg_data.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016*/1*/*/*root &

python sumup_ttree_distrs.py "abs(lep_p4[1].phi())" --cond-com " leps_ID == -13*13 && HLT_mu && lep_matched_HLT[0]" --histo-range 66,-3.3,3.3  --histo-name mumu_phi1_abs_data --output mumu_phi1_abs_data.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016*/1*/*/*root &

python sumup_ttree_distrs.py "abs(abs(lep_p4[1].phi()) - 3.1415)" --cond-com " leps_ID == -13*13 && HLT_mu && lep_matched_HLT[0]" --histo-range 66,-3.3,3.3  --histo-name mumu_phi1_absinv_data --output mumu_phi1_absinv_data.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016*/1*/*/*root &

and in runG:

python sumup_ttree_distrs.py "abs(lep_p4[1].phi())" --cond-com "lep_p4[1].phi() > 0 && leps_ID == -13*13 && HLT_mu && lep_matched_HLT[0]" --histo-range 66,-3.3,3.3  --histo-name mumu_phi1_pos_dataG --output mumu_phi1_pos_dataG.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016G*/1*/*/*root &

python sumup_ttree_distrs.py "abs(lep_p4[1].phi())" --cond-com "lep_p4[1].phi() < 0 && leps_ID == -13*13 && HLT_mu && lep_matched_HLT[0]" --histo-range 66,-3.3,3.3  --histo-name mumu_phi1_neg_dataG --output mumu_phi1_neg_dataG.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016G*/1*/*/*root &

python sumup_ttree_distrs.py "abs(lep_p4[1].phi())" --cond-com " leps_ID == -13*13 && HLT_mu && lep_matched_HLT[0]" --histo-range 66,-3.3,3.3  --histo-name mumu_phi1_abs_dataG --output mumu_phi1_abs_dataG.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016G*/1*/*/*root &

python sumup_ttree_distrs.py "abs(abs(lep_p4[1].phi()) - 3.1415)" --cond-com " leps_ID == -13*13 && HLT_mu && lep_matched_HLT[0]" --histo-range 66,-3.3,3.3  --histo-name mumu_phi1_absinv_dataG --output mumu_phi1_absinv_dataG.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016G*/1*/*/*root &



## elel phi modulations

lep0

python sumup_ttree_distrs.py "abs(lep_p4[0].phi())" --cond-com "lep_p4[0].phi() > 0 && leps_ID == -11*11 && HLT_el && lep_matched_HLT[0]" --histo-range 66,-3.3,3.3  --histo-name elel_phi0_pos_data --output elel_phi0_pos_data.root gstore_outdirs/v27/SingleElectron/Ntupler_v27_Data13TeV_SingleElectron2016*/1*/*/*root &

python sumup_ttree_distrs.py "abs(lep_p4[0].phi())" --cond-com "lep_p4[0].phi() < 0 && leps_ID == -11*11 && HLT_el && lep_matched_HLT[0]" --histo-range 66,-3.3,3.3  --histo-name elel_phi0_neg_data --output elel_phi0_neg_data.root gstore_outdirs/v27/SingleElectron/Ntupler_v27_Data13TeV_SingleElectron2016*/1*/*/*root &

python sumup_ttree_distrs.py "abs(lep_p4[0].phi())" --cond-com " leps_ID == -11*11 && HLT_el && lep_matched_HLT[0]" --histo-range 66,-3.3,3.3  --histo-name elel_phi0_abs_data --output elel_phi0_abs_data.root gstore_outdirs/v27/SingleElectron/Ntupler_v27_Data13TeV_SingleElectron2016*/1*/*/*root &

python sumup_ttree_distrs.py "abs(abs(lep_p4[0].phi()) - 3.1415)" --cond-com " leps_ID == -11*11 && HLT_el && lep_matched_HLT[0]" --histo-range 66,-3.3,3.3  --histo-name elel_phi0_absinv_data --output elel_phi0_absinv_data.root gstore_outdirs/v27/SingleElectron/Ntupler_v27_Data13TeV_SingleElectron2016*/1*/*/*root &


lep1

python sumup_ttree_distrs.py "abs(lep_p4[1].phi())" --cond-com "lep_p4[1].phi() > 0 && leps_ID == -11*11 && HLT_el && lep_matched_HLT[0]" --histo-range 66,-3.3,3.3  --histo-name elel_phi1_pos_data --output elel_phi1_pos_data.root gstore_outdirs/v27/SingleElectron/Ntupler_v27_Data13TeV_SingleElectron2016*/1*/*/*root &

python sumup_ttree_distrs.py "abs(lep_p4[1].phi())" --cond-com "lep_p4[1].phi() < 0 && leps_ID == -11*11 && HLT_el && lep_matched_HLT[0]" --histo-range 66,-3.3,3.3  --histo-name elel_phi1_neg_data --output elel_phi1_neg_data.root gstore_outdirs/v27/SingleElectron/Ntupler_v27_Data13TeV_SingleElectron2016*/1*/*/*root &

python sumup_ttree_distrs.py "abs(lep_p4[1].phi())" --cond-com " leps_ID == -11*11 && HLT_el && lep_matched_HLT[0]" --histo-range 66,-3.3,3.3  --histo-name elel_phi1_abs_data --output elel_phi1_abs_data.root gstore_outdirs/v27/SingleElectron/Ntupler_v27_Data13TeV_SingleElectron2016*/1*/*/*root &

python sumup_ttree_distrs.py "abs(abs(lep_p4[1].phi()) - 3.1415)" --cond-com " leps_ID == -11*11 && HLT_el && lep_matched_HLT[0]" --histo-range 66,-3.3,3.3  --histo-name elel_phi1_absinv_data --output elel_phi1_absinv_data.root gstore_outdirs/v27/SingleElectron/Ntupler_v27_Data13TeV_SingleElectron2016*/1*/*/*root &







# met px py

python sumup_ttree_distrs.py "met_init.Px()" --histo-range 50,-150.,150.  --histo-name met_Px_noreq_tt --output met_Px_noreq_tt.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &

python sumup_ttree_distrs.py "met_init.Py()" --histo-range 50,-150.,150.  --histo-name met_Py_noreq_tt --output met_Py_noreq_tt.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &

python sumup_ttree_distrs.py "met_init.Phi()" --histo-range 66,-3.3,3.3  --histo-name met_Phi_noreq_tt --output met_Phi_noreq_tt.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &

data

python sumup_ttree_distrs.py "met_init.Px()" --histo-range 50,-150.,150.  --histo-name met_Px_noreq_data --output met_Px_noreq_data.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016*/1*/*/*root &

python sumup_ttree_distrs.py "met_init.Py()" --histo-range 50,-150.,150.  --histo-name met_Py_noreq_data --output met_Py_noreq_data.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016*/1*/*/*root &

-- hard to compare them
elmu close req

python sumup_ttree_distrs.py "met_init.Px()" --cond-com "leps_ID == -11*13 && HLT_mu && nbjets > 0" --histo-range 50,-150.,150.  --histo-name met_Px_elmuclose_tt --output met_Px_elmuclose_tt.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &

python sumup_ttree_distrs.py "met_init.Py()" --cond-com "leps_ID == -11*13 && HLT_mu && nbjets > 0" --histo-range 50,-150.,150.  --histo-name met_Py_elmuclose_tt --output met_Py_elmuclose_tt.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &

python sumup_ttree_distrs.py "met_init.Px()" --cond-com "leps_ID == -11*13 && HLT_mu && nbjets > 0" --histo-range 50,-150.,150.  --histo-name met_Px_elmuclose_data --output met_Px_elmuclose_data.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016*/1*/*/*root &

python sumup_ttree_distrs.py "met_init.Py()" --cond-com "leps_ID == -11*13 && HLT_mu && nbjets > 0" --histo-range 50,-150.,150.  --histo-name met_Py_elmuclose_data --output met_Py_elmuclose_data.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016*/1*/*/*root &

met_Py_elmuclose_tt->SetLineColor(kRed)
met_Px_elmuclose_tt->SetLineColor(kRed)

met_Py_elmuclose_tt->Scale(1./met_Py_elmuclose_tt->Integral())
met_Px_elmuclose_tt->Scale(1./met_Px_elmuclose_tt->Integral())

met_Py_elmuclose_data->Scale(1./met_Py_elmuclose_data->Integral())
met_Px_elmuclose_data->Scale(1./met_Px_elmuclose_data->Integral())

met_Py_elmuclose_data->Draw()
met_Py_elmuclose_tt->Draw("same")

met_Px_elmuclose_data->Draw()
met_Px_elmuclose_tt->Draw("same")



same in tt-fsrup (does v25 have elmu?)

python sumup_ttree_distrs.py "met_init.Px()" --cond-com "leps_ID == -11*13 && HLT_mu && nbjets > 0" --histo-range 50,-150.,150.  --histo-name met_Px_elmuclose_tt_fsrup --output met_Px_elmuclose_tt_fsrup.root gstore_outdirs/v25/TT_TuneCUETP8M2T4_13TeV-powheg-fsrup-pythia8/Ntupler_v25_MC2016_Summer16_TTJets_powheg_fsrup/*/0000/*root &

python sumup_ttree_distrs.py "met_init.Py()" --cond-com "leps_ID == -11*13 && HLT_mu && nbjets > 0" --histo-range 50,-150.,150.  --histo-name met_Py_elmuclose_tt_fsrup --output met_Py_elmuclose_tt_fsrup.root gstore_outdirs/v25/TT_TuneCUETP8M2T4_13TeV-powheg-fsrup-pythia8/Ntupler_v25_MC2016_Summer16_TTJets_powheg_fsrup/*/0000/*root &

no req

python sumup_ttree_distrs.py "met_init.Px()" --histo-range 50,-150.,150.  --histo-name met_Px_noreq_tt_fsrup --output met_Px_noreq_tt_fsrup.root gstore_outdirs/v25/TT_TuneCUETP8M2T4_13TeV-powheg-fsrup-pythia8/Ntupler_v25_MC2016_Summer16_TTJets_powheg_fsrup/*/0000/*root &

python sumup_ttree_distrs.py "met_init.Py()" --histo-range 50,-150.,150.  --histo-name met_Py_noreq_tt_fsrup --output met_Py_noreq_tt_fsrup.root gstore_outdirs/v25/TT_TuneCUETP8M2T4_13TeV-powheg-fsrup-pythia8/Ntupler_v25_MC2016_Summer16_TTJets_powheg_fsrup/*/0000/*root &

python sumup_ttree_distrs.py "met_init.Phi()" --histo-range 66,-3.3,3.3  --histo-name met_Phi_noreq_tt_fsrup --output met_Phi_noreq_tt_fsrup.root gstore_outdirs/v25/TT_TuneCUETP8M2T4_13TeV-powheg-fsrup-pythia8/Ntupler_v25_MC2016_Summer16_TTJets_powheg_fsrup/*/0000/*root &

more stats:

python sumup_ttree_distrs.py "met_init.Phi()" --histo-range 66,-3.3,3.3  --histo-name met_Phi_noreq_tt_fsrup --output met_Phi_noreq_tt_fsrup.root gstore_outdirs/v25/TT_TuneCUETP8M2T4_13TeV-powheg-fsrup-pythia8/Ntupler_v25_MC2016_Summer16_TTJets_powheg_fsrup_ext2/*/0000/*root &

met_Phi_noreq_tt->Scale(1./met_Phi_noreq_tt->Integral())
met_Phi_noreq_tt_fsrup->Scale(1./met_Phi_noreq_tt_fsrup->Integral())
met_Phi_noreq_tt_fsrup->SetLineColor(kRed)



the x-y shift of met

python sumup_ttree_distrs.py "met_init.Px():met_init.Py()" --cond-com "leps_ID == -11*13 && HLT_mu && nbjets > 0" --histo-range 50,-150.,150.,50,-150.,150.  --histo-name met_PxPy_elmuclose_tt --output met_PxPy_elmuclose_tt.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &

python sumup_ttree_distrs.py "met_init.Px():met_init.Py()" --cond-com "leps_ID == -11*13 && HLT_mu && nbjets > 0" --histo-range 50,-150.,150.,50,-150.,150.  --histo-name met_PxPy_elmuclose_data --output met_PxPy_elmuclose_data.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016*/1*/*/*root &

-- seems like tt does have a bit larger shift

Mt shape difference with met shifts.
Mt in nominal TT

python sumup_ttree_distrs.py "sqrt(2*(sqrt((met_init.Px()*met_init.Px() + met_init.Py()*met_init.Py())*(lep_p4[0].Px()*lep_p4[0].Px() + lep_p4[0].Py()*lep_p4[0].Py())) - (met_init.Px()*lep_p4[0].Px() + met_init.Py()*lep_p4[0].Py())))" --cond-com "leps_ID == -11*13 && HLT_mu && nbjets > 0" --histo-range 50,0.,250.  --histo-name met_Mt_nom_tt --output met_Mt_nom_tt.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &

shift +4 Px (to zero)

python sumup_ttree_distrs.py "sqrt(2*(sqrt(((met_init.Px() + 4.)*(met_init.Px()+4.) + met_init.Py()*met_init.Py())*(lep_p4[0].Px()*lep_p4[0].Px() + lep_p4[0].Py()*lep_p4[0].Py())) - ((met_init.Px() + 4.)*lep_p4[0].Px() + met_init.Py()*lep_p4[0].Py())))" --cond-com "leps_ID == -11*13 && HLT_mu && nbjets > 0" --histo-range 50,0.,250.  --histo-name met_Mt_Px4_tt --output met_Mt_Px4_tt.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &

shift -4 Px

python sumup_ttree_distrs.py "sqrt(2*(sqrt(((met_init.Px() - 4.)*(met_init.Px() - 4.) + met_init.Py()*met_init.Py())*(lep_p4[0].Px()*lep_p4[0].Px() + lep_p4[0].Py()*lep_p4[0].Py())) - ((met_init.Px() - 4.)*lep_p4[0].Px() + met_init.Py()*lep_p4[0].Py())))" --cond-com "leps_ID == -11*13 && HLT_mu && nbjets > 0" --histo-range 50,0.,250.  --histo-name met_Mt_PxN4_tt --output met_Mt_PxN4_tt.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &

by +10 (more than data)

python sumup_ttree_distrs.py "sqrt(2*(sqrt(((met_init.Px() + 10.)*(met_init.Px() + 10.) + met_init.Py()*met_init.Py())*(lep_p4[0].Px()*lep_p4[0].Px() + lep_p4[0].Py()*lep_p4[0].Py())) - ((met_init.Px() + 10.)*lep_p4[0].Px() + met_init.Py()*lep_p4[0].Py())))" --cond-com "leps_ID == -11*13 && HLT_mu && nbjets > 0" --histo-range 50,0.,250.  --histo-name met_Mt_Px10_tt --output met_Mt_Px10_tt.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &

+20

python sumup_ttree_distrs.py "sqrt(2*(sqrt(((met_init.Px() + 20.)*(met_init.Px() + 20.) + met_init.Py()*met_init.Py())*(lep_p4[0].Px()*lep_p4[0].Px() + lep_p4[0].Py()*lep_p4[0].Py())) - ((met_init.Px() + 20.)*lep_p4[0].Px() + met_init.Py()*lep_p4[0].Py())))" --cond-com "leps_ID == -11*13 && HLT_mu && nbjets > 0" --histo-range 50,0.,250.  --histo-name met_Mt_Px20_tt --output met_Mt_Px20_tt.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &

by +7.2 Px and +1.4 Py (like data)

python sumup_ttree_distrs.py "sqrt(2*(sqrt(((met_init.Px() + 7.2)*(met_init.Px()+7.2) + (met_init.Py()+1.4)*(met_init.Py() + 1.4))*(lep_p4[0].Px()*lep_p4[0].Px() + lep_p4[0].Py()*lep_p4[0].Py())) - ((met_init.Px() + 7.2)*lep_p4[0].Px() + (met_init.Py() + 1.4)*lep_p4[0].Py())))" --cond-com "leps_ID == -11*13 && HLT_mu && nbjets > 0" --histo-range 50,0.,250.  --histo-name met_Mt_PxToData_tt --output met_Mt_PxToData_tt.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &


nominal in data

python sumup_ttree_distrs.py "sqrt(2*(sqrt((met_init.Px()*met_init.Px() + met_init.Py()*met_init.Py())*(lep_p4[0].Px()*lep_p4[0].Px() + lep_p4[0].Py()*lep_p4[0].Py())) - (met_init.Px()*lep_p4[0].Px() + met_init.Py()*lep_p4[0].Py())))" --cond-com "leps_ID == -11*13 && HLT_mu && nbjets > 0" --histo-range 50,0.,250.  --histo-name met_Mt_nom_data --output met_Mt_nom_data.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016*/1*/*/*root &

met_Mt_nom_data->Scale(1./met_Mt_nom_data->Integral())
met_Mt_nom_tt  ->Scale(1./met_Mt_nom_tt  ->Integral())
met_Mt_Px4_tt  ->Scale(1./met_Mt_Px4_tt  ->Integral())
met_Mt_PxN4_tt ->Scale(1./met_Mt_PxN4_tt  ->Integral())
met_Mt_Px10_tt ->Scale(1./met_Mt_Px10_tt  ->Integral())
met_Mt_PxToData_tt ->Scale(1./met_Mt_PxToData_tt  ->Integral())

met_Mt_nom_tt      ->SetLineColor(kRed)
met_Mt_Px4_tt      ->SetLineColor(kRed+1)
met_Mt_PxN4_tt     ->SetLineColor(kRed-1)
met_Mt_Px10_tt     ->SetLineColor(kRed+2)
met_Mt_PxToData_tt ->SetLineColor(kBlack)

met_Mt_nom_tt      ->Draw()
met_Mt_Px4_tt      ->Draw("same")
met_Mt_PxN4_tt     ->Draw("same")


## met shift at Mt region

python sumup_ttree_distrs.py "met_init.Px():met_init.Py()" --cond-com "sqrt(2*(sqrt((met_init.Px()*met_init.Px() + met_init.Py()*met_init.Py())*(lep_p4[0].Px()*lep_p4[0].Px() + lep_p4[0].Py()*lep_p4[0].Py())) - (met_init.Px()*lep_p4[0].Px() + met_init.Py()*lep_p4[0].Py()))) > 120. && leps_ID == -11*13 && HLT_mu && nbjets > 0" --histo-range 50,-150.,150.,50,-150.,150.  --histo-name met_PxPy_elmuclose_tt_Mt120 --output met_PxPy_elmuclose_tt_Mt120.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &

python sumup_ttree_distrs.py "lep_p4[0].Px():lep_p4[0].Py()" --cond-com "sqrt(2*(sqrt((met_init.Px()*met_init.Px() + met_init.Py()*met_init.Py())*(lep_p4[0].Px()*lep_p4[0].Px() + lep_p4[0].Py()*lep_p4[0].Py())) - (met_init.Px()*lep_p4[0].Px() + met_init.Py()*lep_p4[0].Py()))) > 120. && leps_ID == -11*13 && HLT_mu && nbjets > 0" --histo-range 50,-150.,150.,50,-150.,150.  --histo-name met_lep0PxPy_elmuclose_tt_Mt120 --output met_lep0PxPy_elmuclose_tt_Mt120.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &

python sumup_ttree_distrs.py "lep_p4[1].Px():lep_p4[1].Py()" --cond-com "sqrt(2*(sqrt((met_init.Px()*met_init.Px() + met_init.Py()*met_init.Py())*(lep_p4[0].Px()*lep_p4[0].Px() + lep_p4[0].Py()*lep_p4[0].Py())) - (met_init.Px()*lep_p4[0].Px() + met_init.Py()*lep_p4[0].Py()))) > 120. && leps_ID == -11*13 && HLT_mu && nbjets > 0" --histo-range 50,-150.,150.,50,-150.,150.  --histo-name met_lep1PxPy_elmuclose_tt_Mt120 --output met_lep1PxPy_elmuclose_tt_Mt120.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &

python sumup_ttree_distrs.py "lep_p4[0].pt():lep_p4[0].eta()" --cond-com "sqrt(2*(sqrt((met_init.Px()*met_init.Px() + met_init.Py()*met_init.Py())*(lep_p4[0].Px()*lep_p4[0].Px() + lep_p4[0].Py()*lep_p4[0].Py())) - (met_init.Px()*lep_p4[0].Px() + met_init.Py()*lep_p4[0].Py()))) > 120. && leps_ID == -11*13 && HLT_mu && nbjets > 0" --histo-range 50,-2.5.,2.5,50,-150.,150.  --histo-name met_lep0PtEta_elmuclose_tt_Mt120 --output met_lep0PtEta_elmuclose_tt_Mt120.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &

python sumup_ttree_distrs.py "lep_p4[0].eta()" --cond-com "sqrt(2*(sqrt((met_init.Px()*met_init.Px() + met_init.Py()*met_init.Py())*(lep_p4[0].Px()*lep_p4[0].Px() + lep_p4[0].Py()*lep_p4[0].Py())) - (met_init.Px()*lep_p4[0].Px() + met_init.Py()*lep_p4[0].Py()))) > 120. && leps_ID == -11*13 && HLT_mu && nbjets > 0" --histo-range 50,-2.5,2.5  --histo-name met_lep0Eta_elmuclose_tt_Mt120 --output met_lep0Eta_elmuclose_tt_Mt120.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &

python sumup_ttree_distrs.py "lep_p4[1].eta()" --cond-com "sqrt(2*(sqrt((met_init.Px()*met_init.Px() + met_init.Py()*met_init.Py())*(lep_p4[0].Px()*lep_p4[0].Px() + lep_p4[0].Py()*lep_p4[0].Py())) - (met_init.Px()*lep_p4[0].Px() + met_init.Py()*lep_p4[0].Py()))) > 120. && leps_ID == -11*13 && HLT_mu && nbjets > 0" --histo-range 50,-2.5,2.5  --histo-name met_lep1Eta_elmuclose_tt_Mt120 --output met_lep1Eta_elmuclose_tt_Mt120.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &



python sumup_ttree_distrs.py "lep_p4[1].Px()" --cond-com "sqrt(2*(sqrt((met_init.Px()*met_init.Px() + met_init.Py()*met_init.Py())*(lep_p4[0].Px()*lep_p4[0].Px() + lep_p4[0].Py()*lep_p4[0].Py())) - (met_init.Px()*lep_p4[0].Px() + met_init.Py()*lep_p4[0].Py()))) > 120. && leps_ID == -11*13 && HLT_mu && nbjets > 0" --histo-range 50,-100.,100.  --histo-name met_lep1Px_elmuclose_tt_Mt120 --output met_lep1Px_elmuclose_tt_Mt120.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &

python sumup_ttree_distrs.py "lep_p4[0].Px()" --cond-com "sqrt(2*(sqrt((met_init.Px()*met_init.Px() + met_init.Py()*met_init.Py())*(lep_p4[0].Px()*lep_p4[0].Px() + lep_p4[0].Py()*lep_p4[0].Py())) - (met_init.Px()*lep_p4[0].Px() + met_init.Py()*lep_p4[0].Py()))) > 120. && leps_ID == -11*13 && HLT_mu && nbjets > 0" --histo-range 50,-100.,100.  --histo-name met_lep0Px_elmuclose_tt_Mt120 --output met_lep0Px_elmuclose_tt_Mt120.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &

python sumup_ttree_distrs.py "lep_p4[1].Py()" --cond-com "sqrt(2*(sqrt((met_init.Px()*met_init.Px() + met_init.Py()*met_init.Py())*(lep_p4[0].Px()*lep_p4[0].Px() + lep_p4[0].Py()*lep_p4[0].Py())) - (met_init.Px()*lep_p4[0].Px() + met_init.Py()*lep_p4[0].Py()))) > 120. && leps_ID == -11*13 && HLT_mu && nbjets > 0" --histo-range 50,-100.,100.  --histo-name met_lep1Py_elmuclose_tt_Mt120 --output met_lep1Py_elmuclose_tt_Mt120.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &

python sumup_ttree_distrs.py "lep_p4[0].Py()" --cond-com "sqrt(2*(sqrt((met_init.Px()*met_init.Px() + met_init.Py()*met_init.Py())*(lep_p4[0].Px()*lep_p4[0].Px() + lep_p4[0].Py()*lep_p4[0].Py())) - (met_init.Px()*lep_p4[0].Px() + met_init.Py()*lep_p4[0].Py()))) > 120. && leps_ID == -11*13 && HLT_mu && nbjets > 0" --histo-range 50,-100.,100.  --histo-name met_lep0Py_elmuclose_tt_Mt120 --output met_lep0Py_elmuclose_tt_Mt120.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &




data

python sumup_ttree_distrs.py "met_init.Px():met_init.Py()" --cond-com "sqrt(2*(sqrt((met_init.Px()*met_init.Px() + met_init.Py()*met_init.Py())*(lep_p4[0].Px()*lep_p4[0].Px() + lep_p4[0].Py()*lep_p4[0].Py())) - (met_init.Px()*lep_p4[0].Px() + met_init.Py()*lep_p4[0].Py()))) > 120. && leps_ID == -11*13 && HLT_mu && nbjets > 0" --histo-range 50,-150.,150.,50,-150.,150.  --histo-name met_PxPy_elmuclose_data_Mt120 --output met_PxPy_elmuclose_data_Mt120.root gstore_outdirs/v27/SingleMuon/Ntupler_v27_Data13TeV_SingleMuon2016*/1*/*/*root &


brinning MC to symmetry:

python sumup_ttree_distrs.py "lep_p4[0].Px():lep_p4[0].Py()" --cond-com "sqrt(2*(sqrt(((met_init.Px() + 4.0)*(met_init.Px()+4.0) + (met_init.Py()-0.15)*(met_init.Py() - 0.15))*(lep_p4[0].Px()*lep_p4[0].Px() + lep_p4[0].Py()*lep_p4[0].Py())) - ((met_init.Px() + 4.0)*lep_p4[0].Px() + (met_init.Py() - 0.15)*lep_p4[0].Py()))) > 120. && leps_ID == -11*13 && HLT_mu && nbjets > 0" --histo-range 50,-150.,150.,50,-150.,150.  --histo-name met_lep0PxPy_elmuclose_tt_Mt120_shifted --output met_lep0PxPy_elmuclose_tt_Mt120_shifted.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &

python sumup_ttree_distrs.py "lep_p4[0].Px()" --cond-com "sqrt(2*(sqrt(((met_init.Px() + 4.0)*(met_init.Px()+4.0) + (met_init.Py()-0.15)*(met_init.Py() - 0.15))*(lep_p4[0].Px()*lep_p4[0].Px() + lep_p4[0].Py()*lep_p4[0].Py())) - ((met_init.Px() + 4.0)*lep_p4[0].Px() + (met_init.Py() - 0.15)*lep_p4[0].Py()))) > 120. && leps_ID == -11*13 && HLT_mu && nbjets > 0" --histo-range 50,-150.,150.  --histo-name met_lep0Px_elmuclose_tt_Mt120_shifted --output met_lep0Px_elmuclose_tt_Mt120_shifted.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &

python sumup_ttree_distrs.py "lep_p4[0].Py()" --cond-com "sqrt(2*(sqrt(((met_init.Px() + 4.0)*(met_init.Px()+4.0) + (met_init.Py()-0.15)*(met_init.Py() - 0.15))*(lep_p4[0].Px()*lep_p4[0].Px() + lep_p4[0].Py()*lep_p4[0].Py())) - ((met_init.Px() + 4.0)*lep_p4[0].Px() + (met_init.Py() - 0.15)*lep_p4[0].Py()))) > 120. && leps_ID == -11*13 && HLT_mu && nbjets > 0" --histo-range 50,-150.,150.  --histo-name met_lep0Py_elmuclose_tt_Mt120_shifted --output met_lep0Py_elmuclose_tt_Mt120_shifted.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &





## more met phi studies

python sumup_ttree_distrs.py "lep_p4[0].phi()" --histo-range 33,-3.3,3.3 --cond-com "leps_ID == -11*13 && HLT_mu && nbjets > 0" --histo-name met_lep0_phi_tt --output lep0_phi_tt.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &

python sumup_ttree_distrs.py "lep_p4[1].phi()" --histo-range 33,-3.3,3.3 --cond-com "leps_ID == -11*13 && HLT_mu && nbjets > 0" --histo-name met_lep1_phi_tt --output lep1_phi_tt.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &

python sumup_ttree_distrs.py "jet_p4[0].phi()" --histo-range 33,-3.3,3.3 --cond-com "leps_ID == -11*13 && HLT_mu && nbjets > 0" --histo-name met_jet0_phi_tt --output jet0_phi_tt.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &

python sumup_ttree_distrs.py "jet_p4[1].phi()" --histo-range 33,-3.3,3.3 --cond-com "leps_ID == -11*13 && HLT_mu && nbjets > 0" --histo-name met_jet1_phi_tt --output jet1_phi_tt.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &

python sumup_ttree_distrs.py "met_init.phi():met_init.pt()" --histo-range 25,0.,250.,33,-3.3,3.3 --cond-com "leps_ID == -11*13 && HLT_mu && nbjets > 0" --histo-name met_phi_VS_pt_tt --output met_phi_VS_pt_tt.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &

python sumup_ttree_distrs.py "met_init.phi():(met_init.Px()*lep_p4[0].Px() + met_init.Py()*lep_p4[0].Py())/sqrt((met_init.Px()*met_init.Px() + met_init.Py()*met_init.Py())*(lep_p4[0].Px()*lep_p4[0].Px() + lep_p4[0].Py()*lep_p4[0].Py()))" --histo-range 22,-1.1,1.1,33,-3.3,3.3 --cond-com "leps_ID == -11*13 && HLT_mu && nbjets > 0" --histo-name met_phi_VS_cos_tt --output met_phi_VS_cos_tt.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &

cos less than 0

python sumup_ttree_distrs.py "met_init.phi()" --histo-range 33,-3.3,3.3 --cond-com "leps_ID == -11*13 && HLT_mu && nbjets > 0 && (met_init.Px()*lep_p4[0].Px() + met_init.Py()*lep_p4[0].Py())/sqrt((met_init.Px()*met_init.Px() + met_init.Py()*met_init.Py())*(lep_p4[0].Px()*lep_p4[0].Px() + lep_p4[0].Py()*lep_p4[0].Py())) < 0." --histo-name met_phi_cosless0_tt --output met_phi_cosless0_tt.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &

faster

python sumup_ttree_distrs.py "met_init.phi()" --histo-range 33,-3.3,3.3 --cond-com "leps_ID == -11*13 && HLT_mu && nbjets > 0 && (met_init.Px()*lep_p4[0].Px() + met_init.Py()*lep_p4[0].Py()) < 0." --histo-name met_phi_cosless0_tt --output met_phi_cosless0_tt.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &

python sumup_ttree_distrs.py "met_init.phi():(met_init.Px()*lep_p4[0].Px() + met_init.Py()*lep_p4[0].Py())/sqrt((met_init.Px()*met_init.Px() + met_init.Py()*met_init.Py())*(lep_p4[0].Px()*lep_p4[0].Px() + lep_p4[0].Py()*lep_p4[0].Py()))" --histo-range 22,-1.1,1.1,33,-3.3,3.3 --cond-com "leps_ID == -11*13 && abs(lep_id[0]) == 13 && HLT_mu && nbjets > 0" --histo-name met_phi_VS_cosmu_tt --output met_phi_VS_cosmu_tt.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &

cos to electrons:

python sumup_ttree_distrs.py "met_init.phi():(met_init.Px()*lep_p4[0].Px() + met_init.Py()*lep_p4[0].Py())/sqrt((met_init.Px()*met_init.Px() + met_init.Py()*met_init.Py())*(lep_p4[0].Px()*lep_p4[0].Px() + lep_p4[0].Py()*lep_p4[0].Py()))" --histo-range 22,-1.1,1.1,33,-3.3,3.3 --cond-com "leps_ID == -11*13 && abs(lep_id[0]) == 11 && HLT_mu && nbjets > 0" --histo-name met_phi_VS_cosel_tt --output met_phi_VS_cosel_tt.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &

-- no entries here, muons are stacked first, no sort pt after that

python sumup_ttree_distrs.py "met_init.phi():(met_init.Px()*lep_p4[1].Px() + met_init.Py()*lep_p4[1].Py())/sqrt((met_init.Px()*met_init.Px() + met_init.Py()*met_init.Py())*(lep_p4[1].Px()*lep_p4[1].Px() + lep_p4[1].Py()*lep_p4[1].Py()))" --histo-range 22,-1.1,1.1,33,-3.3,3.3 --cond-com "leps_ID == -11*13 && abs(lep_id[1]) == 11 && HLT_mu && nbjets > 0" --histo-name met_phi_VS_cosel_tt --output met_phi_VS_cosel_tt.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &

elel channel

python sumup_ttree_distrs.py "met_init.phi()" --histo-range 33,-3.3,3.3 --cond-com "leps_ID == -11*11 && HLT_el && nbjets > 0" --histo-name met_phi_elel_tt --output met_phi_elel_tt.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &

mumu channel

python sumup_ttree_distrs.py "met_init.phi()" --histo-range 33,-3.3,3.3 --cond-com "leps_ID == -13*13 && HLT_mu && nbjets > 0" --histo-name met_phi_mumu_tt --output met_phi_mumu_tt.root gstore_outdirs/v27/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v27_MC2016_Summer16_TTJets_powheg/*/0000/*root &










# tt in pf5


python jobsums/get_shapes.py --formula "pF4:pF5" -c ctr_old_mu_sel -d Mt_lep_met_f -p tt_mutau pF4:merge-sets/v26/pF4/MC2016_Summer16_TTJets_powheg.root pF5:merge-sets/v26/pF5/MC2016_Summer16_TTJets_powheg.root




# nvtx presel-sel

python jobsums/get_shapes.py --formula "presel:sel" -c ctr_old_mu_sel -d nvtx -p data presel:merge-sets/v25/p3/SingleMuon.root:ctr_old_mu_presel,data,NOMINAL,nvtx  sel:merge-sets/v25/pF3/SingleMuon.root:ctr_old_mu_sel,data,NOMINAL,nvtx


# Mt per era

python jobsums/get_shapes.py --formula "B+C+D+E+F:G+H2+H3" -c ctr_old_mu_sel -d Mt_lep_met_f -p data B:merge-sets/v25/pF3/Data13TeV_SingleMuon2016B_03Feb2017_ver2.root  C:merge-sets/v25/pF3/Data13TeV_SingleMuon2016C_03Feb2017_v1.root    D:merge-sets/v25/pF3/Data13TeV_SingleMuon2016D_03Feb2017_v1.root    E:merge-sets/v25/pF3/Data13TeV_SingleMuon2016E_03Feb2017_v1.root    F:merge-sets/v25/pF3/Data13TeV_SingleMuon2016F_03Feb2017_v1.root G:merge-sets/v25/pF3/Data13TeV_SingleMuon2016G_03Feb2017_v1.root H2:merge-sets/v25/pF3/Data13TeV_SingleMuon2016H_03Feb2017_ver2.root H3:merge-sets/v25/pF3/Data13TeV_SingleMuon2016H_03Feb2017_ver3.root






python sumup_ttree_distrs.py "jet_matching_lep[0]" --histo-range 5,0,5 --cond-com "abs(leps_ID) == 13 && HLT_mu && lep_matched_HLT[0] && tau_IDlev[0] > 2 && njets > 2 && nbjets > 0" --histo-name tt_jet0_lepmatch_mu1t3j1b_v25 --output tt_jet0_lepmatch_mu1t3j1b_v25.root gstore_outdirs/v25/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v25_MC2016_Summer16_TTJets_powheg/180409_022217/0000/*root &

python sumup_ttree_distrs.py "jet_matching_lep[0]" --histo-range 5,0,5 --cond-com "abs(leps_ID) == 11 && HLT_el && lep_matched_HLT[0] && tau_IDlev[0] > 2 && njets > 2 && nbjets > 0" --histo-name tt_jet0_lepmatch_el1t3j1b_v25 --output tt_jet0_lepmatch_el1t3j1b_v25.root gstore_outdirs/v25/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v25_MC2016_Summer16_TTJets_powheg/180409_022217/0000/*root &








python sumup_ttree_distrs.py "jet_p4[0].pt()" --histo-range 200,0,300 --cond-com "\! jet_matching_lep[0] && abs(leps_ID) == 13 && HLT_mu && lep_matched_HLT[0] && tau_IDlev[0] > 2 && njets > 2 && nbjets > 0" --histo-name tt_jet0_pt_nolep_1t3j1b_v25 --output tt_jet0_pt_nolep_1t3j1b_v25.root gstore_outdirs/v25/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v25_MC2016_Summer16_TTJets_powheg/180409_022217/0000/*root &

python sumup_ttree_distrs.py "jet_initial_p4[0].pt()" --histo-range 200,0,300 --cond-com "\! jet_matching_lep[0] && abs(leps_ID) == 13 && HLT_mu && lep_matched_HLT[0] && tau_IDlev[0] > 2 && njets > 2 && nbjets > 0" --histo-name tt_jet0_pt_initial_nolep_1t3j1b_v25 --output tt_jet0_pt_initial_nolep_1t3j1b_v25.root gstore_outdirs/v25/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v25_MC2016_Summer16_TTJets_powheg/180409_022217/0000/*root &

python sumup_ttree_distrs.py "jet_uncorrected_p4[0].pt() * jet_jes_recorrection[0] * jet_jer_factor[0]" --histo-range 200,0,300 --cond-com "\! jet_matching_lep[0] && abs(leps_ID) == 13 && HLT_mu && lep_matched_HLT[0] && tau_IDlev[0] > 2 && njets > 2 && nbjets > 0" --histo-name tt_jet0_pt_recor_nolep_1t3j1b_v25 --output tt_jet0_pt_recor_nolep_1t3j1b_v25.root gstore_outdirs/v25/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v25_MC2016_Summer16_TTJets_powheg/180409_022217/0000/*root &

python sumup_ttree_distrs.py "jet_uncorrected_p4[0].pt() * jet_jer_factor[0]" --histo-range 200,0,300 --cond-com "\! jet_matching_lep[0] && abs(leps_ID) == 13 && HLT_mu && lep_matched_HLT[0] && tau_IDlev[0] > 2 && njets > 2 && nbjets > 0" --histo-name tt_jet0_pt_recorJER_nolep_1t3j1b_v25 --output tt_jet0_pt_recorJER_nolep_1t3j1b_v25.root gstore_outdirs/v25/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v25_MC2016_Summer16_TTJets_powheg/180409_022217/0000/*root &

python sumup_ttree_distrs.py "jet_uncorrected_p4[0].pt() * jet_jes_recorrection[0]" --histo-range 200,0,300 --cond-com "\! jet_matching_lep[0] && abs(leps_ID) == 13 && HLT_mu && lep_matched_HLT[0] && tau_IDlev[0] > 2 && njets > 2 && nbjets > 0" --histo-name tt_jet0_pt_recorJES_nolep_1t3j1b_v25 --output tt_jet0_pt_recorJES_nolep_1t3j1b_v25.root gstore_outdirs/v25/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v25_MC2016_Summer16_TTJets_powheg/180409_022217/0000/*root &


# miniaod jet * jer -- the default recommendation

python sumup_ttree_distrs.py "jet_initial_p4[0].pt() * jet_jer_factor[0]" --histo-range 200,0,300 --cond-com "\! jet_matching_lep[0] && abs(leps_ID) == 13 && HLT_mu && lep_matched_HLT[0] && tau_IDlev[0] > 2 && njets > 2 && nbjets > 0" --histo-name tt_jet0_pt_CorJER_nolep_1t3j1b_v25 --output tt_jet0_pt_CorJER_nolep_1t3j1b_v25.root gstore_outdirs/v25/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v25_MC2016_Summer16_TTJets_powheg/180409_022217/0000/*root &


hadd tt_jet_distrs.root tt_jet0_pt_recorJER_nolep_1t3j1b_v25.root tt_jet0_pt_recor_nolep_1t3j1b_v25.root tt_jet0_pt_initial_nolep_1t3j1b_v25.root tt_jet0_pt_nolep_1t3j1b_v25.root tt_jet0_pt_recorJES_nolep_1t3j1b_v25.root tt_jet0_pt_CorJER_nolep_1t3j1b_v25.root


# lep matched jets

python sumup_ttree_distrs.py "jet_initial_p4[0].pt() * jet_jer_factor[0]" --histo-range 200,0,300 --cond-com "jet_matching_lep[0] && abs(leps_ID) == 13 && HLT_mu && lep_matched_HLT[0] && tau_IDlev[0] > 2 && njets > 2 && nbjets > 0" --histo-name tt_jet0_pt_CorJER_LepMatch_1t3j1b_v25 --output tt_jet0_pt_CorJER_LepMatch_1t3j1b_v25.root gstore_outdirs/v25/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v25_MC2016_Summer16_TTJets_powheg/180409_022217/0000/*root &


python sumup_ttree_distrs.py "jet_initial_p4[0].pt()" --histo-range 200,0,300 --cond-com "jet_matching_lep[0] && abs(leps_ID) == 13 && HLT_mu && lep_matched_HLT[0] && tau_IDlev[0] > 2 && njets > 2 && nbjets > 0" --histo-name tt_jet0_pt_initial_LepMatch_1t3j1b_v25 --output tt_jet0_pt_initial_LepMatch_1t3j1b_v25.root gstore_outdirs/v25/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v25_MC2016_Summer16_TTJets_powheg/180409_022217/0000/*root &


python sumup_ttree_distrs.py "jet_p4[0].pt()" --histo-range 200,0,300 --cond-com "jet_matching_lep[0] && abs(leps_ID) == 13 && HLT_mu && lep_matched_HLT[0] && tau_IDlev[0] > 2 && njets > 2 && nbjets > 0" --histo-name tt_jet0_pt_LepMatch_1t3j1b_v25 --output tt_jet0_pt_LepMatch_1t3j1b_v25.root gstore_outdirs/v25/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v25_MC2016_Summer16_TTJets_powheg/180409_022217/0000/*root &

hadd tt_jet_distrs_LepMatched.root tt_jet0_pt_LepMatch_1t3j1b_v25.root tt_jet0_pt_initial_LepMatch_1t3j1b_v25.root tt_jet0_pt_CorJER_LepMatch_1t3j1b_v25.root






python sumup_ttree_distrs.py "jet_initial_p4[0].pt() - jet_uncorrected_p4[0].pt() * jet_jes_recorrection[0]" --histo-range 200,-100,100 --cond-com "\! jet_matching_lep[0] && abs(leps_ID) == 13 && HLT_mu && lep_matched_HLT[0] && tau_IDlev[0] > 2 && njets > 2 && nbjets > 0" --histo-name tt_jet0_diff_initJES_nolep_1t3j1b_v25 --output tt_jet0_diff_initJES_nolep_1t3j1b_v25.root gstore_outdirs/v25/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v25_MC2016_Summer16_TTJets_powheg/180409_022217/0000/*root &

python sumup_ttree_distrs.py "jet_uncorrected_jecFactor[0] * jet_jes_recorrection[0]" --histo-range 200,-100,100 --cond-com "\! jet_matching_lep[0] && abs(leps_ID) == 13 && HLT_mu && lep_matched_HLT[0] && tau_IDlev[0] > 2 && njets > 2 && nbjets > 0" --histo-name tt_jet0_uncorReJES_nolep_1t3j1b_v25 --output tt_jet0_uncorReJES_nolep_1t3j1b_v25.root gstore_outdirs/v25/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v25_MC2016_Summer16_TTJets_powheg/180409_022217/0000/*root &

python sumup_ttree_distrs.py "jet_initial_p4[0].pt() - jet_uncorrected_p4[0].pt() * jet_jes_recorrection[0]" --histo-range 200,-100,100 --cond-com "\! jet_matching_lep[0] && abs(leps_ID) == 13 && HLT_mu && lep_matched_HLT[0] && tau_IDlev[0] > 2 && njets > 2 && nbjets > 0" --histo-name data_jet0_diff_initJES_nolep_1t3j1b_v25 --output data_jet0_diff_initJES_nolep_1t3j1b_v25.root gstore_outdirs/v25/SingleMuon/Ntupler_v25_Data13TeV_SingleMuon2016*/1*/*/*root &




python sumup_ttree_distrs.py "jet_uncorrected_p4[0].pt()" --histo-range 200,0,300 --cond-com "\! jet_matching_lep[0] && abs(leps_ID) == 13 && HLT_mu && lep_matched_HLT[0] && tau_IDlev[0] > 2 && njets > 2 && nbjets > 0" --histo-name tt_jet0_pt_uncor_nolep_1t3j1b_v25 --output tt_jet0_pt_uncor_nolep_1t3j1b_v25.root gstore_outdirs/v25/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v25_MC2016_Summer16_TTJets_powheg/180409_022217/0000/*root &

python sumup_ttree_distrs.py "jet_initial_p4[0].pt() * jet_uncorrected_jecFactor[0]" --histo-range 200,0,300 --cond-com "\! jet_matching_lep[0] && abs(leps_ID) == 13 && HLT_mu && lep_matched_HLT[0] && tau_IDlev[0] > 2 && njets > 2 && nbjets > 0" --histo-name tt_jet0_pt_uncor2_nolep_1t3j1b_v25 --output tt_jet0_pt_uncor2_nolep_1t3j1b_v25.root gstore_outdirs/v25/TT_TuneCUETP8M2T4_13TeV-powheg-pythia8/Ntupler_v25_MC2016_Summer16_TTJets_powheg/180409_022217/0000/*root &

hadd tt_jets_uncor.root tt_jet0_pt_uncor_nolep_1t3j1b_v25.root tt_jet0_pt_uncor2_nolep_1t3j1b_v25.root









# change in Mt shape with tau selection

python distr_ratios.py --logy --leg-chan --y-range 0.001,100. ../merge-sets/v26/pF5/MC2016_Summer16_TTJets_powheg.root -c ctr_old_mu_presel:Mt_lep_met_f -p tt_lj --ratio-channel-distrs ctr_old_mu_presel2b:Mt_lep_met_f,ctr_old_mu_selVloose:Mt_lep_met_f,ctr_old_mu_sel:Mt_lep_met_f --title "" --title-x "M_{T}(#mu, MET)"

python distr_ratios.py --logy --leg-chan --y-range 0.001,100. ../merge-sets/v26/pF5/MC2016_Summer16_TTJets_powheg.root -c ctr_old_mu_presel:Mt_lep_met_f -p tt_mutau --ratio-channel-distrs ctr_old_mu_presel2b:Mt_lep_met_f,ctr_old_mu_selVloose:Mt_lep_met_f,ctr_old_mu_sel:Mt_lep_met_f --title "" --title-x "M_{T}(#mu, MET)"

missing these two:

python distr_ratios.py --logy --leg-chan --y-range 0.001,100. ../merge-sets/v26/pF5/MC2016_Summer16_TTJets_powheg.root -c ctr_old_el_presel:Mt_lep_met_f -p tt_lj --ratio-channel-distrs ctr_old_el_presel2b:Mt_lep_met_f,ctr_old_el_selVloose:Mt_lep_met_f,ctr_old_el_sel:Mt_lep_met_f --title "" --title-x "M_{T}(e, MET)"

python distr_ratios.py --logy --leg-chan --y-range 0.001,100. ../merge-sets/v26/pF5/MC2016_Summer16_TTJets_powheg.root -c ctr_old_el_presel:Mt_lep_met_f -p tt_eltau --ratio-channel-distrs ctr_old_el_presel2b:Mt_lep_met_f,ctr_old_el_selVloose:Mt_lep_met_f,ctr_old_el_sel:Mt_lep_met_f --title "" --title-x "M_{T}(e, MET)"

instead for now:

python distr_ratios.py --logy --leg-chan --y-range 0.001,100. ../merge-sets/v26/pF4/MC2016_Summer16_TTJets_powheg.root -c ctr_old_el_selVloose:Mt_lep_met_f -p tt_lj --ratio-channel-distrs ctr_old_el_sel:Mt_lep_met_f --title "" --title-x "M_{T}(e, MET)"

python distr_ratios.py --logy --leg-chan --y-range 0.001,100. ../merge-sets/v26/pF4/MC2016_Summer16_TTJets_powheg.root -c ctr_old_el_selVloose:Mt_lep_met_f -p tt_eltau --ratio-channel-distrs ctr_old_el_sel:Mt_lep_met_f --title "" --title-x "M_{T}(e, MET)"

and same with mu:

python distr_ratios.py --logy --leg-chan --y-range 0.001,100. ../merge-sets/v26/pF4/MC2016_Summer16_TTJets_powheg.root -c ctr_old_mu_selVloose:Mt_lep_met_f -p tt_lj --ratio-channel-distrs ctr_old_mu_sel:Mt_lep_met_f --title "" --title-x "M_{T}(#mu, MET)"

python distr_ratios.py --logy --leg-chan --y-range 0.001,100. ../merge-sets/v26/pF4/MC2016_Summer16_TTJets_powheg.root -c ctr_old_mu_selVloose:Mt_lep_met_f -p tt_mutau --ratio-channel-distrs ctr_old_mu_sel:Mt_lep_met_f --title "" --title-x "M_{T}(#mu, MET)"




# Mt dependence on tau pt

python distr_ratios.py mc_v25p2_v26p2.root -c ctr_old_el_sel:Mt_lep_met_f -p tt_lj --ratio-channel-distrs ctr_old_el_sel:Mt_lep_met_t2,ctr_old_el_sel:Mt_lep_met_t3,ctr_old_el_sel:Mt_lep_met_t4,ctr_old_el_sel:Mt_lep_met_t5,ctr_old_el_sel:Mt_lep_met_t6 --title "" --title-x "M_{T}(e, MET)"

python distr_ratios.py mc_v25p2_v26p2.root -c ctr_old_el_sel:Mt_lep_met_f -p tt_eltau --ratio-channel-distrs ctr_old_el_sel:Mt_lep_met_t2,ctr_old_el_sel:Mt_lep_met_t3,ctr_old_el_sel:Mt_lep_met_t4,ctr_old_el_sel:Mt_lep_met_t5,ctr_old_el_sel:Mt_lep_met_t6 --title "" --title-x "M_{T}(e, MET)"



python distr_ratios.py mc_v25p2_v26p2.root -c ctr_old_mu_sel:Mt_lep_met_f -p tt_lj --ratio-channel-distrs ctr_old_mu_sel:Mt_lep_met_t2,ctr_old_mu_sel:Mt_lep_met_t3,ctr_old_mu_sel:Mt_lep_met_t4,ctr_old_mu_sel:Mt_lep_met_t5,ctr_old_mu_sel:Mt_lep_met_t6 --title "" --title-x "M_{T}(#mu, MET)"

python distr_ratios.py mc_v25p2_v26p2.root -c ctr_old_mu_sel:Mt_lep_met_f -p tt_mutau --ratio-channel-distrs ctr_old_mu_sel:Mt_lep_met_t2,ctr_old_mu_sel:Mt_lep_met_t3,ctr_old_mu_sel:Mt_lep_met_t4,ctr_old_mu_sel:Mt_lep_met_t5,ctr_old_mu_sel:Mt_lep_met_t6 --title "" --title-x "M_{T}(#mu, MET)"








weights:
weight         0.95
pu             1.05
bSF            0.97
record_weight  0.96


syst_weights_nominal = [weight, weight_pu, 1., 1.]
weight, weight_PU, weight_top_pt, weight_th = syst_weights_nominal
nom_sys_weight       = weight * weight_th * weight_PU * weight_top_pt
record_weight        = nom_sys_weight * weight_bSF



before that:

weight = 1.
weight *= el_trg_sf[0] * el_sfs_reco[0] * el_sfs_id[0]

weight control histos for el SFs:
trk  0.988
id   0.981
trg  0.97713
0.988 * 0.981 * 0.977 = 0.9469
all  0.948

-- matches



-- How do you treat using both the inclusive W+jets sample as well as the dedicated W+1-4jets samples?

In the presented version of AN the dedicated samples are just added to the inclusive sample. For lumi normalization the cross-section of inclusive sample is reduced by the sum of N-jet cross-sections.
Previously a stitching procedure over generator level "number of particles parameter" NUP was used. But due to couple issues it was turned off.
And since the contribution of WJets is small in final selection (5%), the stitching was not applied for time being.
Now different approaches to WJets have been well reviewed with the conclusion to return to using the stitching procedure with WNJets, it provides enough statistics and good modeling of Mt and other distributions.



Also the aMCatNLO WJets was considered. The dataset performed well at preselection but lacked statistics for final selection (the extended dataset of aMCatNLO was not included at that time).
Now the stitching and overall behavior of WJets MC has being reviewed with the following results.

In wjets control region and in preselection three versions of WJets models are considered: 1) inclusive Madgraph WJets, 2) Madgraph WNJets with the inclusive dataset added as W0Jets with required cut on NUP parameter, 3) the inclusive aMCatNLO dataset.
And all extended datasets are included for these MC.
The QCD and all other processes are taken from MC.
The events in W0Jets sample are required to have NUP different from the values in WNJets. Which means NUP < 6 (W1Jets has NUP = 6, W2Jets NUP = 7 etc).
Standard cross-sections (reported in table 1) are used for inclusive Madgraph and aMCatNLO, in case on NJets the cross section of W0Jets = inclusive - sum(WNJets).

For each of WJets I test different normalization factors, trying to match MC to Data at high values of lepton pt, met and Mt -- i.e. the kinematic regions without QCD.
First of all the shapes of all distributions in all 3 models of WJets mostly agree. *TODO add comparative plots of WJets shape.*
The WNJets is a bit closer to aMCatNLO than just the inclusive Madgraph. However inclusive Madgraph is not significantly different.
Then, the normalization shows close agreement with the value of NLO cross section used for aMCatNLO 61.500 fb:
the aMCatNLO WJets get the normalization factor of 0.96,
inclusive Madgraph gets 1.25 which brings it close to aMCatNLO 50.6 * 1.24 = 62.9 fb.
*Add plots of the distributions with the normalization factors as text labels on them. And add event yield tables.*
And also it is useful to notice that the MC QCD matches the data well in these regions when it is multiplied by a factor about of two (more precisely 1.75).
*Plots with normalized QCD.*
(This factor also shows up in study of QCD modeling.)

The stithced Madgraph WNJets resemble aMCatNLO well and have good statistics in some regions of data. But in our main selection they end up lacking statistics.
*The W0Jets pass the selection? -- add numbers on that. And final decision to switch to aMCatNLO or just inclusive Madgraph, depending on statistics.*






((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_final_pdgId[ 0]:gen_final_PromptFinal[ 0]:gen_final_chainId[ 0]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_final_pdgId[ 1]:gen_final_PromptFinal[ 1]:gen_final_chainId[ 1]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_final_pdgId[ 2]:gen_final_PromptFinal[ 2]:gen_final_chainId[ 2]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_final_pdgId[ 3]:gen_final_PromptFinal[ 3]:gen_final_chainId[ 3]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_final_pdgId[ 4]:gen_final_PromptFinal[ 4]:gen_final_chainId[ 4]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_final_pdgId[ 5]:gen_final_PromptFinal[ 5]:gen_final_chainId[ 5]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_final_pdgId[ 6]:gen_final_PromptFinal[ 6]:gen_final_chainId[ 6]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_final_pdgId[ 7]:gen_final_PromptFinal[ 7]:gen_final_chainId[ 7]", "", "", 1)


((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_final_pdgId[ 8]:gen_final_PromptFinal[ 8]:gen_final_chainId[ 8]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_final_pdgId[ 9]:gen_final_PromptFinal[ 9]:gen_final_chainId[ 9]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_final_pdgId[10]:gen_final_PromptFinal[10]:gen_final_chainId[10]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_final_pdgId[11]:gen_final_PromptFinal[11]:gen_final_chainId[11]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_final_pdgId[12]:gen_final_PromptFinal[12]:gen_final_chainId[12]", "", "", 1)



((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_final_pdgId[0]:gen_final_PromptFinal[0]:gen_final_PromptDecayed[0]:gen_final_fromHardFinal[0]:gen_final_PromptTauDecay[0]:gen_final_chainId[0]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_final_pdgId[1]:gen_final_PromptFinal[1]:gen_final_PromptDecayed[1]:gen_final_fromHardFinal[1]:gen_final_PromptTauDecay[1]:gen_final_chainId[1]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_final_pdgId[2]:gen_final_PromptFinal[2]:gen_final_PromptDecayed[2]:gen_final_fromHardFinal[2]:gen_final_PromptTauDecay[2]:gen_final_chainId[2]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_final_pdgId[3]:gen_final_PromptFinal[3]:gen_final_PromptDecayed[3]:gen_final_fromHardFinal[3]:gen_final_PromptTauDecay[3]:gen_final_chainId[3]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_final_pdgId[4]:gen_final_PromptFinal[4]:gen_final_PromptDecayed[4]:gen_final_fromHardFinal[4]:gen_final_PromptTauDecay[4]:gen_final_chainId[4]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_final_pdgId[5]:gen_final_PromptFinal[5]:gen_final_PromptDecayed[5]:gen_final_fromHardFinal[5]:gen_final_PromptTauDecay[5]:gen_final_chainId[5]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_final_pdgId[6]:gen_final_PromptFinal[6]:gen_final_PromptDecayed[6]:gen_final_fromHardFinal[6]:gen_final_PromptTauDecay[6]:gen_final_chainId[6]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_final_pdgId[7]:gen_final_PromptFinal[7]:gen_final_PromptDecayed[7]:gen_final_fromHardFinal[7]:gen_final_PromptTauDecay[7]:gen_final_chainId[7]", "", "", 1)



((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_PromptDecayed_pdgId[ 0]:gen_PromptDecayed_status[ 0]:gen_PromptDecayed_ndaughters[ 0]:gen_PromptDecayed_chainId[ 0]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_PromptDecayed_pdgId[ 1]:gen_PromptDecayed_status[ 1]:gen_PromptDecayed_ndaughters[ 1]:gen_PromptDecayed_chainId[ 1]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_PromptDecayed_pdgId[ 2]:gen_PromptDecayed_status[ 2]:gen_PromptDecayed_ndaughters[ 2]:gen_PromptDecayed_chainId[ 2]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_PromptDecayed_pdgId[ 3]:gen_PromptDecayed_status[ 3]:gen_PromptDecayed_ndaughters[ 3]:gen_PromptDecayed_chainId[ 3]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_PromptDecayed_pdgId[ 4]:gen_PromptDecayed_status[ 4]:gen_PromptDecayed_ndaughters[ 4]:gen_PromptDecayed_chainId[ 4]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_PromptDecayed_pdgId[ 5]:gen_PromptDecayed_status[ 5]:gen_PromptDecayed_ndaughters[ 5]:gen_PromptDecayed_chainId[ 5]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_PromptDecayed_pdgId[ 6]:gen_PromptDecayed_status[ 6]:gen_PromptDecayed_ndaughters[ 6]:gen_PromptDecayed_chainId[ 6]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_PromptDecayed_pdgId[ 7]:gen_PromptDecayed_status[ 7]:gen_PromptDecayed_ndaughters[ 7]:gen_PromptDecayed_chainId[ 7]", "", "", 1)




((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_t_b_final_pdgIds[ 0]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_t_b_final_pdgIds[ 1]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_t_b_final_pdgIds[ 2]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_t_b_final_pdgIds[ 3]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_t_b_final_pdgIds[ 4]", "", "", 1)

((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_tb_b_final_pdgIds[ 0]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_tb_b_final_pdgIds[ 1]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_tb_b_final_pdgIds[ 2]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_tb_b_final_pdgIds[ 3]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_tb_b_final_pdgIds[ 4]", "", "", 1)

((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_t_w1_final_pdgIds[ 0]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_t_w1_final_pdgIds[ 1]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_t_w1_final_pdgIds[ 2]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_t_w1_final_pdgIds[ 3]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_t_w1_final_pdgIds[ 4]", "", "", 1)

((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_t_w2_final_pdgIds[ 0]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_t_w2_final_pdgIds[ 1]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_t_w2_final_pdgIds[ 2]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_t_w2_final_pdgIds[ 3]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_t_w2_final_pdgIds[ 4]", "", "", 1)

((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_tb_w1_final_pdgIds[ 0]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_tb_w1_final_pdgIds[ 1]", "", "", 1)

((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_tb_w2_final_pdgIds[ 0]", "", "", 1)
((TTree*) ntupler->Get("reduced_ttree"))->Scan("gen_tb_w2_final_pdgIds[ 1]", "", "", 1)

gen_t_b_final_pdgIds






mutau_l0->Divide(mutau_all)
mutau_l1->Divide(mutau_all)
mutau_l2->Divide(mutau_all)
mutau_l3->Divide(mutau_all)
mutau_l4->Divide(mutau_all)

mutau_l1->SetLineColor(kRed + 0)
mutau_l2->SetLineColor(kRed + 1)
mutau_l3->SetLineColor(kRed + 2)
mutau_l4->SetLineColor(kRed + 3)

mutau_l0->Draw()
mutau_l1->Draw("same")
mutau_l2->Draw("same")
mutau_l3->Draw("same")
mutau_l4->Draw("same")


TLegend* leg = new TLegend(0.7,0.7,1,1)
leg->AddEntry(mutau_l0, "vloose/all", "L")
leg->AddEntry(mutau_l1, "loose/all", "L")
leg->AddEntry(mutau_l2, "medium/all", "L")
leg->AddEntry(mutau_l3, "tight/all", "L")
leg->AddEntry(mutau_l4, "vtight/all", "L")

leg->Draw("same")





python stack_postfit.py fitDiagnosticsElShapesPostFitDistr.root ctr_old_el_sel_ljout --title-x "Mt(lep, MET)"

# crab submition

for d in `cat dsets_feb_rereco`
python make_crab_cfgs.py $d v13-0 Dilep_tauID

for d in `cat dsets_ext_wjets_dyjets `
python make_crab_cfgs.py $d v13-0 Dilep_tauID

for c in `ls python/crab_cfgs/v13-0/*crab.py`
crab submit -c $c

for c in `cat new_sub`
do
crab submit -c $c
done

for c in `cat dsets_feb_rereco`
do
python make_crab_cfgs.py $c v13-1 Dilep_tauID
done

for c in `ls python/crab_cfgs/v13-1/*crab.py`
crab submit -c $c


## resubmit

--force for resubmit finished jobs

for j in `cat fresh_crabs`
do
crab resubmit --force -d $j
done



## status

for c in `ls crab_projects/crab_Ntupler_v13-0_* -d`
do
  crab status -d $c
done







# track info in TrackMatch TTree

((TTree*) tauMatch->Get("tauMatch_ttree"))->Scan("tau_IDlev[0]:tau_p4[0].E(): tau_flightLength[0]: tau_SV_dist[0]: tau_SV_fit_track_OS_matched_gen_dR[tau_refited_index[0]]:tau_SV_fit_track_SS1_matched_gen_dR[tau_refited_index[0]]:tau_SV_fit_track_SS2_matched_gen_dR[tau_refited_index[0]]: tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]]:tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]]:tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]]: track_b[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]]:track_b[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]]:track_b[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]]: track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta():track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta():track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(): track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi():track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi():track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(): track_vertex_key[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]]:track_vertex_key[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]]:track_vertex_key[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]]: track_vertex_association[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]]:track_vertex_association[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]]:track_vertex_association[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]] ", "tau_IDlev[0]>1 && gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1", "")

# only track b
((TTree*) tauMatch->Get("tauMatch_ttree"))->Scan("tau_IDlev[0]:tau_p4[0].E(): tau_flightLength[0]: tau_SV_dist[0]: tau_SV_fit_track_OS_matched_gen_dR[tau_refited_index[0]]:tau_SV_fit_track_SS1_matched_gen_dR[tau_refited_index[0]]:tau_SV_fit_track_SS2_matched_gen_dR[tau_refited_index[0]]: tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]]:tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]]:tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]]: track_b[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]]:track_b[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]]:track_b[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]] ", "tau_IDlev[0]>1 && gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1", "")


# sum of b angles check

((TTree*) tauMatch->Get("tauMatch_ttree"))->Scan(" tau_flightLength[0]: tau_SV_dist[0]: tau_SV_fit_track_OS_matched_gen_dR[tau_refited_index[0]]:tau_SV_fit_track_SS1_matched_gen_dR[tau_refited_index[0]]:tau_SV_fit_track_SS2_matched_gen_dR[tau_refited_index[0]]: tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]]:tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]]:tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]]: track_b[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]]:track_b[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]]:track_b[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]]: b_anglesum(track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]]) ", "tau_IDlev[0]>1 && gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1", "")

((TTree*) tauMatch->Get("tauMatch_ttree"))->Scan(" tau_flightLength[0]: tau_SV_dist[0]: tau_gen_dR[0]: b_anglesum(track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]]) ", "tau_IDlev[0]>1 && gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1", "")

((TTree*) tauMatch->Get("tauMatch_ttree"))->Scan(" tau_flightLength[0]: tau_SV_dist[0]: tau_gen_dR[0]: b_anglesum(track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]]) ", "tau_IDlev[0]>1 && gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1", "")

((TTree*) tauMatch->Get("tauMatch_ttree"))->Scan(" tau_flightLength[0]: tau_SV_dist[0]: tau_gen_dR[0]: b_anglesum(track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]]): v_angle( track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(),track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi()): v_angle( track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(),track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi()): v_angle( track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(),track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(),track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi()) ", "tau_IDlev[0]>1 && gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1", "")

# b angles VS track angles
# with ref vtx key

((TTree*) tauMatch->Get("tauMatch_ttree"))->Scan(" tau_flightLength[0]: tau_SV_dist[0]: tau_gen_dR[0]: track_vertex_key[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]]:track_vertex_key[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]]:track_vertex_key[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]]: b_angle(track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]]): b_angle(track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]]): b_angle(track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]]): v_angle( track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(),track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi()): v_angle( track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(),track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi()): v_angle( track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(),track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(),track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi()) ", "tau_IDlev[0]>1 && gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1", "")

# b product track
# is b perpendicular to track?

b_prod_track

((TTree*) tauMatch->Get("tauMatch_ttree"))->Scan(" tau_flightLength[0]: tau_SV_dist[0]: tau_gen_dR[0]: b_angle_track( track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi()) : b_angle_track( track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi()) : b_angle_track( track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi()) ", "tau_IDlev[0]>1 && gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1", "")

# b SV

double b_SV(
	Float_t b1x, Float_t b1y, Float_t b1z,
	Float_t b2x, Float_t b2y, Float_t b2z,
	Float_t v1eta, Float_t v1phi,
	Float_t v2eta, Float_t v2phi
	)

root [5] ((TTree*) tauMatch->Get("tauMatch_ttree"))->Scan(" tau_flightLength[0]: tau_SV_dist[0]: tau_gen_dR[0]: b_SV(
track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]],  track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]],  track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]],
track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]],
track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]],
track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(),  track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(),
track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(),
track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi()
) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1)", "")

# OS SS1
((TTree*) tauMatch->Get("tauMatch_ttree"))->Scan(" tau_flightLength[0]: tau_SV_dist[0]: tau_gen_dR[0]: b_SV( track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]],  track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]],  track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(),  track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi()) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1)", "")

# OS SS2
((TTree*) tauMatch->Get("tauMatch_ttree"))->Scan(" tau_flightLength[0]: tau_SV_dist[0]: tau_gen_dR[0]: b_SV( track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]],  track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]],  track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(),  track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi()) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1)", "")

# SS1 SS2
((TTree*) tauMatch->Get("tauMatch_ttree"))->Scan(" tau_flightLengthSignificance[0]: tau_flightLength[0]: tau_SV_dist[0]: tau_gen_dR[0]: b_SV( track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi()) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1)", "")

# SVs spatial position
double b_SV_1_dist(
	Float_t b1x, Float_t b1y, Float_t b1z,
	Float_t b2x, Float_t b2y, Float_t b2z,
	Float_t v1eta, Float_t v1phi,
	Float_t v2eta, Float_t v2phi)

# SS1 SS2
((TTree*) tauMatch->Get("tauMatch_ttree"))->Scan(" tau_flightLengthSignificance[0]: tau_flightLength[0]: tau_SV_dist[0]: tau_gen_dR[0]: b_SV_1_dist( track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi()): b_SV_2_dist( track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi()) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1)", "")

((TTree*) tauMatch->Get("tauMatch_ttree"))->Scan(" tau_flightLengthSignificance[0]: tau_flightLength[0]: tau_SV_dist[0]: tau_gen_dR[0]: b_SV_1_dist( track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi())  ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1)", "")
((TTree*) tauMatch->Get("tauMatch_ttree"))->Scan(" tau_flightLengthSignificance[0]: tau_flightLength[0]: tau_SV_dist[0]: tau_gen_dR[0]: b_SV_2_dist( track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi())  ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1)", "")






# all stuff together

# angle sum and all b SV-s
# preparation
((TTree*) tauMatch->Get("tauMatch_ttree"))->Scan(" tau_flightLengthSignificance[0]: tau_flightLength[0]: tau_SV_dist[0]: tau_gen_dR[0]:
b_anglesum(track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]],
track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]],
track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]]):

b_SV( track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]],  track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]],  track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]],
track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]],
track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(),  track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(),
track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi()):

b_SV( track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]],
track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]],
track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(),
track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi()):

b_SV( track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]],
track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]],
track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(),
track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi())
", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1)", "")

((TTree*) tauMatch->Get("tauMatch_ttree"))->Scan(" tau_flightLengthSignificance[0]: tau_flightLength[0]: tau_SV_dist[0]: tau_gen_dR[0]: b_anglesum(track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]]): b_SV( track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]],  track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]],  track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(),  track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi()): b_SV( track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi()) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1)", "")

((TTree*) tauMatch->Get("tauMatch_ttree"))->Scan(" b_SV( track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi()) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1)", "")

# and track info
((TTree*) tauMatch->Get("tauMatch_ttree"))->Scan(" tau_flightLengthSignificance[0]: tau_flightLength[0]: tau_SV_dist[0]: tau_gen_dR[0]:
b_anglesum(track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]]):
b_SV( track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]],  track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]],  track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(),  track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi()):
b_SV( track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi()):
b_SV( track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi())
", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1)", "")





# simple SV on b info
# FINAL on Friday

# with tau pt
# absolutely different from just directions...
root [72] ((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw("
b_simple_SV_pt(
 track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]],
 track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]],
 track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]],

 track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]],
 track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]],
 track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]],

 track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]],
 track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]],
 track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]],

 track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(),
 track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(),
 track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(),

 track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(),
 track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(),
 track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(),

 track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(),
 track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(),
 track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi() ) >>h(100,-2,2) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")



# b_simple_SV_pt_direction_penalty

((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw("
b_simple_SV_pt_direction_penalty(
 0,
 track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]],
 track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]],
 track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]],

 track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]],
 track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]],
 track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]],

 track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]],
 track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]],
 track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]],

 track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(),
 track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(),
 track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(),

 track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(),
 track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(),
 track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(),

 track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(),
 track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(),
 track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi() ) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")

((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" b_simple_SV_pt_direction_penalty( 0, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi() ) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")

# REPEAT FRIDAY
((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" b_simple_SV_pt_direction_penalty( 10, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi() ) >>h(100,-20,5) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")

# against b discr tau_dR_matched_jet
((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" tau_dR_matched_jet[0] ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")

((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" jet_b_discr[tau_dR_matched_jet[0]]: b_simple_SV_pt_direction_penalty( 10, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi() ) >>h(50,-20,5,20,0,1) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 && tau_dR_matched_jet[0] > -1", "")

((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" jet_b_discr[tau_dR_matched_jet[0]]: b_simple_SV_pt_direction_penalty( 10, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi() ) >>h(50,-20,5,20,0,1) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 && tau_dR_matched_jet[0] > -1", "")

# correlation is there
# cut at 0.9
((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" b_simple_SV_pt_direction_penalty( 10, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi() ) >>h(100,-20,5) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 && tau_dR_matched_jet[0] > -1 && jet_b_discr[tau_dR_matched_jet[0]] < 0.9 ", "")

((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" b_simple_SV_pt_direction_penalty( 10, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi() ) >>h(100,-20,5) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 && tau_dR_matched_jet[0] > -1 && jet_b_discr[tau_dR_matched_jet[0]] < 0.9 ", "")

# Medium tau IDlev > 2 and Tight > 3
((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" b_simple_SV_pt_direction_penalty( 10, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi() ) >>h(100,-20,5) ", "tau_IDlev[0]>3 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 && tau_dR_matched_jet[0] > -1 && jet_b_discr[tau_dR_matched_jet[0]] < 0.9 ", "")






# tests
((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" b_simple_SV_pt_direction_penalty( 4, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi() ) >> h(100, -5,5) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")

((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" b_simple_SV_pt_direction_penalty( 3, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi() ) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")

((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" b_simple_SV_pt_direction_penalty( 11, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi() ) >> h(100, 0, 10)", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")


((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" b_simple_SV_pt_direction_penalty( 18, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi() ) >> h(100,0,20) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")

((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" b_simple_SV_pt_direction_penalty( 18, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi() ) >> h(100,0,20) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")



# with histo range
((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" b_simple_SV_pt_direction_penalty( 0, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi() ) >> h(100, -1, 10)", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")

((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" b_simple_SV_pt_direction_penalty( 0, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi() ) >> h(100, 0, 3)", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")








# save

root [52] ((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw("b_plane_unitary_volume( track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]]): b_anglesum( track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]] ) >> h(20,0,7, 20,-0.1,0.1)", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "col")


root [52] ((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" b_anglesum( track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]] ) >> h(20,0,7, 20,-0.1,0.1)", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "col")

((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw("track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]] ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "col")

((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw("track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]] :track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]] >>h(20,-0.005,0.005,20,-0.005,0.005) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "col")
((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw("track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]] :track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]] >>h(20,-0.001,0.001,20,-0.001,0.001) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "col")
# lj
((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw("track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]] :track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]] >>h(20,-0.0005,0.0005,20,-0.0005,0.0005) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "col")
((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw("track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]] :track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]] >>h(20,-0.005,0.005,20,-0.0005,0.0005) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "col")



((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" b_Eta( track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]]) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "col")

# PV and tracking errors
((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" PV_x[0]:PV_z[0]>>h(20,-12,12, 20,0.095,0.115) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "col")
((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" PV_x_err[0]:PV_z_err[0]>>h(20,0,0.005,0,002) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "col")



# check corrected bz approzch
((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" b_cor_angle_trk( track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), tau_p4[0].eta(), tau_p4[0].phi() ) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "col")

# SV out of corrected Z
double corZ_average_SV(
	Float_t b1x, Float_t b1y, Float_t b1z,
	Float_t b2x, Float_t b2y, Float_t b2z,
	Float_t b3x, Float_t b3y, Float_t b3z,
	Float_t v1eta, Float_t v1phi,
	Float_t v2eta, Float_t v2phi,
	Float_t v3eta, Float_t v3phi
	)
        {
	Float_t tracker_error = 0.2; // approximately systematic error on positions

((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw("
corZ_average_SV(
 track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]],
 track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]],
 track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]],

 track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]],
 track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]],
 track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]],

 track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]],
 track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]],
 track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]],

 track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(),
 track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(),
 track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(),

 track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(),
 track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(),
 track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(),

 track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(),
 track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(),
 track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi() ) >>h(100,-2,2) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")

((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" corZ_average_SV( track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi() ) >>h(100,-15,5) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")

((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" corZ_average_SV( track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi() ) >>h(100,-15,5) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")





double b_track_plane_intersections_average(
	Float_t b1x, Float_t b1y, Float_t b1z,
	Float_t b2x, Float_t b2y, Float_t b2z,
	Float_t b3x, Float_t b3y, Float_t b3z,
	Float_t v1pt, Float_t v1eta, Float_t v1phi,
	Float_t v2pt, Float_t v2eta, Float_t v2phi,
	Float_t v3pt, Float_t v3eta, Float_t v3phi,
	Float_t taupt, Float_t taueta, Float_t tauphi
	)

((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" b_track_plane_intersections_average(
 track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]],
 track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]],
 track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]],

 track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]],
 track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]],
 track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]],

 track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]],
 track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]],
 track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]],

 track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(),
 track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(),
 track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(),

 track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(),
 track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(),
 track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(),

 track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(),
 track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(),
 track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi() ) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")



((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" b_track_plane_intersections_average_perp_angle(1, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi() ) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")


# breaking with typos
root [7] ((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" b_track_plane_intersections_average_perp_angle(2, track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi() ) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")

((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" b_track_plane_intersections_average_perp_angle(3, track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), tau_p4[0].pt(), tau_p4[0].eta(), tau_p4[0].phi() ) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")

((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" b_track_plane_intersections_average_perp_angle(3, track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), tau_p4[0].pt(), tau_p4[0].eta(), tau_p4[0].phi() ) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")


# fixing
((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" b_track_plane_intersections_average_perp_angle(3, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi() , tau_p4[0].pt(), tau_p4[0].eta(), tau_p4[0].phi() ) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")



# ok, trying SV out of this

double b_track_plane_intersections_raw_SV(
        int which, //
        Float_t b1x, Float_t b1y, Float_t b1z,
        Float_t b2x, Float_t b2y, Float_t b2z,
        Float_t b3x, Float_t b3y, Float_t b3z,
        Float_t v1pt, Float_t v1eta, Float_t v1phi,
        Float_t v2pt, Float_t v2eta, Float_t v2phi,
        Float_t v3pt, Float_t v3eta, Float_t v3phi,
        Float_t taupt, Float_t taueta, Float_t tauphi
        )

((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" b_track_plane_intersections_raw_SV( track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), tau_p4[0].pt(), tau_p4[0].eta(), tau_p4[0].phi() ) >>h(100,-5,5) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")

# new name:
((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" optimal_directions_intersections_raw_SV( 0, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), tau_p4[0].pt(), tau_p4[0].eta(), tau_p4[0].phi() ) >>h(100,-5,5) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")






























# TESTING angle-sum in true and fake
# and as a penalty for Sign
# SV loose taus, no cuts, for shape

# a "canv-starter" call
((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw("  lep_p4[0].pt() ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")

# angle sum is 5
((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" optimal_directions_intersections_raw_SV( 5, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), tau_p4[0].pt(), tau_p4[0].eta(), tau_p4[0].phi() )  ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")

((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" optimal_directions_intersections_raw_SV( 5, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), tau_p4[0].pt(), tau_p4[0].eta(), tau_p4[0].phi() )  ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")

TH1D* h_ = (TH1D*) ((TTree*) tauMatch->Get("tauMatch_ttree"))->GetHistogram()
TH1D* h_lt = (TH1D*) h_->Clone()
h_lt->SetDirectory(0)
h_lt->SetName("lt")

h_ = (TH1D*) ((TTree*) tauMatch->Get("tauMatch_ttree"))->GetHistogram()
TH1D* h_lj = (TH1D*) h_->Clone()
h_lj->SetDirectory(0)
h_lj->SetName("lt")
h_lj->SetLineColor(kRed)

h_lt->Scale(1/h_lt->Integral())
h_lj->Scale(1/h_lj->Integral())

# SV with anglesum penalty is 49
((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" optimal_directions_intersections_raw_SV( 49, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), tau_p4[0].pt(), tau_p4[0].eta(), tau_p4[0].phi() ) >>h(66,-1,10)", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")

((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" optimal_directions_intersections_raw_SV( 49, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), tau_p4[0].pt(), tau_p4[0].eta(), tau_p4[0].phi() ) >>h(66,-1,10) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")


h_ = (TH1D*) ((TTree*) tauMatch->Get("tauMatch_ttree"))->GetHistogram()
TH1D* h_lt_sign = (TH1D*) h_->Clone()
h_lt_sign->SetDirectory(0)
h_lt_sign->SetName("lt_sign")

h_ = (TH1D*) ((TTree*) tauMatch->Get("tauMatch_ttree"))->GetHistogram()
TH1D* h_lj_sign = (TH1D*) h_->Clone()
h_lj_sign->SetDirectory(0)
h_lj_sign->SetName("lt_sign")
h_lj_sign->SetLineColor(kRed)


h_lt_sign->Scale(1/h_lt_sign->Integral())
h_lj_sign->Scale(1/h_lj_sign->Integral())

h_lj_sign->Draw()
h_lt_sign->Draw("same")

# --- looks like the same as without angle
# the angle ~= other penalties, which are already there







# MISMATCH in NTUPLES (FIXED -- had a typo in dR match sigCands - tracks)
# it seems optimal_directions_intersections_raw_SV 29 is used in ntuple
# the tests were done in
# ~/work/private/16/CMSSW_8_0_26_patch1/src/UserCode/ttbar-leptons-80X/outdir/tauMatch-1/merged-sets
# -- it is full TT dataset

# tests
# SV loose taus, no cuts, for shape
((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" optimal_directions_intersections_raw_SV( 29, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), tau_p4[0].pt(), tau_p4[0].eta(), tau_p4[0].phi() ) >>h(100,-1,20) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")

# len
# reminder: 0th tau has index to refitted tau stuff and to dR jet
((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" optimal_directions_intersections_raw_SV( 39, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), tau_p4[0].pt(), tau_p4[0].eta(), tau_p4[0].phi() ) >>h(100,-1,20) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")

# sign, len VS b-sicr
# sign VS b
((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" jet_b_discr[tau_dR_matched_jet[0]] : optimal_directions_intersections_raw_SV( 29, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), tau_p4[0].pt(), tau_p4[0].eta(), tau_p4[0].phi() ) >>h(21,-1,20, 20,0,1) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 && tau_dR_matched_jet[0] > -1 ", "col")
# zoom
((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" jet_b_discr[tau_dR_matched_jet[0]] : optimal_directions_intersections_raw_SV( 29, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), tau_p4[0].pt(), tau_p4[0].eta(), tau_p4[0].phi() ) >>h(16,4,20, 20,0,1) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 && tau_dR_matched_jet[0] > -1 ", "col")
# and same for l-jets
# ...

# 3 charged particles in simple_tau_id
((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" jet_b_discr[tau_dR_matched_jet[0]] : optimal_directions_intersections_raw_SV( 29, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), tau_p4[0].pt(), tau_p4[0].eta(), tau_p4[0].phi() ) >>h(21,-1,20, 20,0,1) ", "tau_IDlev[0]>1 && ((abs(gen_t_w_decay_id) == 13 && abs(gen_tb_w_decay_id) >= 15*30 ) || (abs(gen_tb_w_decay_id) == 13 && abs(gen_t_w_decay_id) >= 15*30 )) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 && tau_dR_matched_jet[0] > -1 ", "col")


# len
((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" jet_b_discr[tau_dR_matched_jet[0]] : optimal_directions_intersections_raw_SV( 39, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), tau_p4[0].pt(), tau_p4[0].eta(), tau_p4[0].phi() ) >>h(21,-0.1,1, 20,0,1) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 && tau_dR_matched_jet[0] > -1 ", "col")

# VS energy
((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" tau_p4[0].energy() : optimal_directions_intersections_raw_SV( 29, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), tau_p4[0].pt(), tau_p4[0].eta(), tau_p4[0].phi() ) >>h(21,-1,20, 20,20,150) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 && tau_dR_matched_jet[0] > -1 ", "col")

# more 2 Sign
((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" tau_p4[0].energy() : optimal_directions_intersections_raw_SV( 29, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), tau_p4[0].pt(), tau_p4[0].eta(), tau_p4[0].phi() ) >>h(16,4,20, 20,20,150) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 && tau_dR_matched_jet[0] > -1 ", "col")


# redo cumulative ratios
# real selection, Tight & anti-b-discr, for 3ch true tau and fake taus

((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" optimal_directions_intersections_raw_SV( 29, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), tau_p4[0].pt(), tau_p4[0].eta(), tau_p4[0].phi() ) >>h(100,-1,20) ", "tau_IDlev[0]>3 && ((abs(gen_t_w_decay_id) == 13 && abs(gen_tb_w_decay_id) >= 15*30 ) || (abs(gen_tb_w_decay_id) == 13 && abs(gen_t_w_decay_id) >= 15*30 )) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 && tau_dR_matched_jet[0] > -1 && jet_b_discr[tau_dR_matched_jet[0]] < 0.9 ", "")





# ok, now it segfaults all the time
((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]] ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")

# correl with deviation
((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw("optimal_directions_intersections_raw_SV( 17, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), tau_p4[0].pt(), tau_p4[0].eta(), tau_p4[0].phi() ) : optimal_directions_intersections_raw_SV( 27, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), tau_p4[0].pt(), tau_p4[0].eta(), tau_p4[0].phi() ) >>h(20,0,0.01,20,0,0.3) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "col")

# correlate convergence fractoins, SS1 vs OS
((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw("optimal_directions_intersections_raw_SV( 25, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), tau_p4[0].pt(), tau_p4[0].eta(), tau_p4[0].phi() ) : optimal_directions_intersections_raw_SV( 24, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), tau_p4[0].pt(), tau_p4[0].eta(), tau_p4[0].phi() ) >>h(20,0,1.1,20,0,1.1)  ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "col")


((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" optimal_directions_intersections_raw_SV( 2, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), tau_p4[0].pt(), tau_p4[0].eta(), tau_p4[0].phi() ) >>h(100,0,0.1) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")

# b cuts
((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" optimal_directions_intersections_raw_SV( 4, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), tau_p4[0].pt(), tau_p4[0].eta(), tau_p4[0].phi() )  ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 && tau_dR_matched_jet[0] > -1 && jet_b_discr[tau_dR_matched_jet[0]] < 0.9 ", "")

((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" optimal_directions_intersections_raw_SV( 29, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), tau_p4[0].pt(), tau_p4[0].eta(), tau_p4[0].phi() ) >>h(100,-1,20)  ", "tau_IDlev[0]>3 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 && tau_dR_matched_jet[0] > -1 && jet_b_discr[tau_dR_matched_jet[0]] < 0.9 ", "")

((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" optimal_directions_intersections_raw_SV( 16, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), tau_p4[0].pt(), tau_p4[0].eta(), tau_p4[0].phi() ) >>h(100,-5,20)  ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")

((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" max_track_bis_angle( 1, track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].pt(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi() ) >>h(100,0,0.2) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")


# XY plane

((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" xy_b_track_pair_bestpoint_tests( 1, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi()) >> h(100, -1, 1) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")


# SV test
((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" xy_average_SV( 1, track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi()) >>h(100,-1,1) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")

((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" abs(tau_p4[0].eta()): xy_average_SV( 0, track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi()) >>h(30,-1,15, 20,0,2.5) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "col")

((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" abs(tau_p4[0].eta()): xy_average_SV( 0, track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi()) >>h(30,-1,15, 20,0,2.5) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "col")

# energy dep for central taus
((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" tau_p4[0].energy(): xy_average_SV( 0, track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi()) >>h(30,-1,15, 30,0,150) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 && abs(tau_p4[0].eta()) < 1.5", "col")

((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" tau_p4[0].energy(): xy_average_SV( 0, track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi()) >>h(30,-1,15, 30,0,150) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 && abs(tau_p4[0].eta()) < 1.5", "col")

((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" tau_p4[0].energy(): xy_average_SV( 0, track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi()) >>h(20,0,5, 20,20,100) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 && abs(tau_p4[0].eta()) < 0.5", "col")


# with tau direction
((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" tau_p4[0].energy(): xy_average_SV( 0, track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi()) >>h(20,-2,5, 20,20,100) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 && abs(tau_p4[0].eta()) < 0.5", "col")

((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" xy_average_SV( 0, track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi()) >>h(100,-10,5) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 && abs(tau_p4[0].eta()) < 0.5", "col")
((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" xy_average_SV( 0, track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi()) >>h(100,-10,5) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 && abs(tau_p4[0].eta()) < 0.5", "col")

((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" xy_average_SV( -1, track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi()) >>h(100,-2,1) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 && abs(tau_p4[0].eta()) < 0.5", "col")

# proj on tau scaled per dev-s
((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" xy_average_SV( -3, track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi()) >>h(100,-5,20) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "col")

((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" xy_average_SV( -3, track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi()) >>h(100,-5,20) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "col")



xy_plane_b_tau_directions
((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" xy_plane_b_tau_directions( 1, track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi())  ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 && abs(tau_p4[0].eta()) < 0.5", "col")


((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" xy_average_SV( -3,
track_b_x[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]],
track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]],
track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]],

track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS2_matched_track[tau_refited_index[0]]].phi(),
track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(),
track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi()) >>h(100,-20,5) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id == 1 || gen_tb_w_decay_id == 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "col")

((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" xy_b_track_pair_bestpoint_test( 8, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi()) >>h(100,-10,10) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")

((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" xy_b_track_pair_bestpoint_test( 1, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi()) >>h(100,-1,1) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")
((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" xy_b_track_pair_bestpoint_test( 2, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi()) >>h(100,-1,1) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")
((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" xy_b_track_pair_bestpoint_test( 7, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi()) >>h(100,-1,1) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")


((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" xy_b_track_pair_bestpoint_test( 10, track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_x[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_b_z[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]], track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]].phi(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].eta(), track_p4[tau_SV_fit_track_OS_matched_track[tau_refited_index[0]]].phi(), tau_p4[0].phi()) >>h(100,-0.001,0.001) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")

# negating b doesn't change its' angle with tau -- HOW COME?
double xy_b_delirium_Phi(
	Float_t b1x, Float_t b1y
	)


((TTree*) tauMatch->Get("tauMatch_ttree"))->Scan(" tau_p4[0].phi(): xy_b_delirium_Phi(track_b_x[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]], track_b_y[tau_SV_fit_track_SS1_matched_track[tau_refited_index[0]]]) ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "", 20)

double xy_b_delirium_tauPhi(
	Float_t taueta, Float_t tauphi

((TTree*) tauMatch->Get("tauMatch_ttree"))->Draw(" xy_b_delirium_tauPhi(tau_p4[0].eta(), tau_p4[0].phi())  ", "tau_IDlev[0]>1 && (gen_t_w_decay_id != 1 && gen_tb_w_decay_id != 1) && tau_SV_fit_track_OS_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS1_matched_track_dR[tau_refited_index[0]] + tau_SV_fit_track_SS2_matched_track_dR[tau_refited_index[0]] < 0.002 ", "")


